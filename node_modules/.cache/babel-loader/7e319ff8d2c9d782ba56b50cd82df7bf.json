{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useCallback,useRef,useEffect,useState}from\"react\";import axios from'axios';import TUICalendar from\"@toast-ui/react-calendar\";import\"tui-calendar/dist/tui-calendar.css\";import\"tui-date-picker/dist/tui-date-picker.css\";import'../../../assets/css/calendar.css';import\"tui-time-picker/dist/tui-time-picker.css\";import WhiteButton from'../../modules/button/white_button';// const start = new Date();\n// const end = new Date(new Date().setMinutes(start.getMinutes() + 30));\nimport{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var calendarColor=[\"#ef6f87\",\"#e49d5a\",\"#e4ce5a\",\"#7ddc8b\",\"#c0afff\",\"#9fcae8\",\"#F23DA0\",\"#3C5FA6\",\"#F28705\",\"#467326\",\"#D99066\",\"#ff5722\"];// const calendarInstructor = [\"#ef6f87\",\"#e49d5a\", \"#2196f3\", \"#7ddc8b\" ,\"#c0afff\",\"#9fcae8\",\"#F23DA0\", \"#3C5FA6\", \"#F28705\", \"#467326\", \"#D99066\", \"#ff5722\"];\nfunction CommonCalendar(props){var cal=useRef(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),schedules=_useState2[0],setschedules=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),calendars=_useState4[0],setcalendars=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),year=_useState6[0],setyear=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),month=_useState8[0],setmonth=_useState8[1];useEffect(function(){if(props.calendarData!==null){var data=props.calendarData;// var index = 0;\nvar tempSchedule=[];if(props.path!==null&&props.path===\"/admin/academy_date\"){for(var i=0;i<data.length;i++){tempSchedule.push({calendarId:data[i].category_id,category:\"time\",isAllDay:true,isVisible:true,title:data[i].name,id:data[i].id,start:data[i].date,end:data[i].date});}setschedules(tempSchedule);}}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[props.calendarData]);useEffect(function(){if(props.categoryData!==null){var data=props.categoryData;var tempCalendar=[];var index=0;for(var i=0;i<data.length;i++){tempCalendar.push({id:data[i].id,name:data[i].name,color:calendarColor[index],bgColor:calendarColor[index]+\"40\",dragBgColor:calendarColor[index]+\"40\",borderColor:calendarColor[index]});index++;if(index===calendarColor.length)index=0;}setcalendars(tempCalendar);}},[props.categoryData]);useEffect(function(){var today=new Date();var year=today.getFullYear();// 년도\nvar month=today.getMonth()+1;// 월\n// let date = today.getDate();  // 날짜\n// let day = today.getDay();  // 요일\nif(month<10)month=\"0\"+month;setyear(year);setmonth(month);},[]);var onClickSchedule=useCallback(function(e){var _e$schedule=e.schedule,calendarId=_e$schedule.calendarId,id=_e$schedule.id;cal.current.calendarInst.getElement(id,calendarId);},[]);var createAcademy=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var date,year,month,day,academy_date,addAcademy;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:date=data.start._date;year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();if(month<10)month=\"0\"+month;if(day<10)day=\"0\"+day;academy_date=year+\"-\"+month+\"-\"+day;addAcademy={name:data.title,date:academy_date,category_id:data.calendarId,token:window.sessionStorage.getItem('token')};axios({url:process.env.REACT_APP_RESTAPI_HOST+'academyDate',method:'post',data:addAcademy}).then(function(res){props.readAcademy();});case 9:case\"end\":return _context.stop();}}},_callee);}));return function createAcademy(_x){return _ref.apply(this,arguments);};}();var updateAcademy=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var schedule,changes,date,changeCategoryId,changeTitle,year,month,day,changeDate,updateAcademy;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:schedule=e.schedule,changes=e.changes;date=schedule.start._date;changeCategoryId=schedule.calendarId;changeTitle=schedule.title;if(changes.hasOwnProperty('start'))date=changes.start._date;if(changes.hasOwnProperty('calendarId'))changeCategoryId=changes.calendarId;if(changes.hasOwnProperty('title'))changeTitle=changes.title;year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();if(month<10)month=\"0\"+month;if(day<10)day=\"0\"+day;changeDate=year+\"-\"+month+\"-\"+day;updateAcademy={id:schedule.id,name:changeTitle,date:changeDate,category_id:changeCategoryId,token:window.sessionStorage.getItem('token')};axios({url:process.env.REACT_APP_RESTAPI_HOST+'academyDate',method:'put',data:updateAcademy}).then(function(res){props.readAcademy();});case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function updateAcademy(_x2){return _ref2.apply(this,arguments);};}();var deleteAcademy=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(window.confirm(\"학사일정을 삭제하시겠습니까?\")){axios({url:process.env.REACT_APP_RESTAPI_HOST+'academyDate',method:'delete',data:{id:id,token:window.sessionStorage.getItem('token')}}).then(function(res){props.readAcademy();});}case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteAcademy(_x3){return _ref3.apply(this,arguments);};}();var onBeforeCreateSchedule=useCallback(function(scheduleData){if(window.confirm(\"학사 일정을 추가하시겠습니까?\")){createAcademy(scheduleData);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var onBeforeDeleteSchedule=useCallback(function(res){// eslint-disable-next-line no-unused-vars\nvar _res$schedule=res.schedule,id=_res$schedule.id,calendarId=_res$schedule.calendarId;deleteAcademy(id);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var onBeforeUpdateSchedule=useCallback(function(e){if(window.confirm(\"일정을 수정하시겠습니까?\")){updateAcademy(e);}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);function _getFormattedTime(time){var date=new Date(time);var h=date.getHours();var m=date.getMinutes();return\"\".concat(h,\":\").concat(m);}function _getTimeTemplate(schedule,isAllDay){var html=[];if(!isAllDay){html.push(\"<strong>\"+_getFormattedTime(schedule.start)+\"</strong> \");}if(schedule.isPrivate){html.push('<span class=\"calendar-font-icon ic-lock-b\"></span>');html.push(\" Private\");}else{if(schedule.isReadOnly){html.push('<span class=\"calendar-font-icon ic-readonly-b\"></span>');}else if(schedule.recurrenceRule){html.push('<span class=\"calendar-font-icon ic-repeat-b\"></span>');}else if(schedule.attendees.length){html.push('<span class=\"calendar-font-icon ic-user-b\"></span>');}else if(schedule.location){html.push('<span class=\"calendar-font-icon ic-location-b\"></span>');}html.push(\" \"+schedule.title);}return html.join(\"\");}var templates={time:function time(schedule){return _getTimeTemplate(schedule,false);}};var NextButton=useCallback(function(e){if(cal!==null){var calendarInstance=cal.current.getInstance();calendarInstance.next();var m=calendarInstance.getDate().getMonth()+1;var y=calendarInstance.getDate().getFullYear();if(m<10)m=\"0\"+m;// var date = y+\"-\"+m;\nsetmonth(m);setyear(y);}},[]);var PrevButton=useCallback(function(e){if(cal!==null){var calendarInstance=cal.current.getInstance();calendarInstance.prev();var m=calendarInstance.getDate().getMonth()+1;var y=calendarInstance.getDate().getFullYear();if(m<10)m=\"0\"+m;// var date = y+\"-\"+m;\nsetmonth(m);setyear(y);// props.readMainCalendar(date)\n}},[]);var TodayButton=useCallback(function(e){if(cal!==null){var calendarInstance=cal.current.getInstance();calendarInstance.today();var m=calendarInstance.getDate().getMonth()+1;var y=calendarInstance.getDate().getFullYear();if(m<10)m=\"0\"+m;// var date = y+\"-\"+m;\nsetmonth(m);setyear(y);}},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"calendar-title\",children:[year,\"\\uB144 \",month,\"\\uC6D4\\uC758 \\uD559\\uC0AC\\uC77C\\uC815\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb15\",children:[/*#__PURE__*/_jsx(WhiteButton,{class:\"mr15\",name:\"\\uC624\\uB298\\uB0A0\\uC9DC\",click:TodayButton}),/*#__PURE__*/_jsx(WhiteButton,{class:\"mr15\",name:\"<\",click:PrevButton}),/*#__PURE__*/_jsx(WhiteButton,{name:\">\",click:NextButton})]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"right\",marginBottom:\"15px\"},children:props.categoryData!==null?props.categoryData.map(function(category,index){return/*#__PURE__*/_jsxs(\"span\",{className:\"mr15\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"color-circle\",style:{background:calendarColor[index]}}),/*#__PURE__*/_jsx(\"span\",{children:category.name})]},category.id);}):null}),/*#__PURE__*/_jsx(TUICalendar,{ref:cal,height:\"100%\",view:\"month\",useCreationPopup:true,useDetailPopup:true,template:templates,calendars:calendars,schedules:schedules,onClickSchedule:onClickSchedule,onBeforeCreateSchedule:onBeforeCreateSchedule,onBeforeDeleteSchedule:onBeforeDeleteSchedule,onBeforeUpdateSchedule:onBeforeUpdateSchedule})]});}export default CommonCalendar;","map":{"version":3,"sources":["/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/src/components/modules/calendar/crud_calendar.js"],"names":["React","useCallback","useRef","useEffect","useState","axios","TUICalendar","WhiteButton","calendarColor","CommonCalendar","props","cal","schedules","setschedules","calendars","setcalendars","year","setyear","month","setmonth","calendarData","data","tempSchedule","path","i","length","push","calendarId","category_id","category","isAllDay","isVisible","title","name","id","start","date","end","categoryData","tempCalendar","index","color","bgColor","dragBgColor","borderColor","today","Date","getFullYear","getMonth","onClickSchedule","e","schedule","current","calendarInst","getElement","createAcademy","_date","day","getDate","academy_date","addAcademy","token","window","sessionStorage","getItem","url","process","env","REACT_APP_RESTAPI_HOST","method","then","res","readAcademy","updateAcademy","changes","changeCategoryId","changeTitle","hasOwnProperty","changeDate","deleteAcademy","confirm","onBeforeCreateSchedule","scheduleData","onBeforeDeleteSchedule","onBeforeUpdateSchedule","_getFormattedTime","time","h","getHours","m","getMinutes","_getTimeTemplate","html","isPrivate","isReadOnly","recurrenceRule","attendees","location","join","templates","NextButton","calendarInstance","getInstance","next","y","PrevButton","prev","TodayButton","textAlign","marginBottom","map","background"],"mappings":"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","sourcesContent":["import React, { useCallback, useRef, useEffect, useState } from \"react\";\nimport axios from 'axios';\nimport TUICalendar from \"@toast-ui/react-calendar\";\n\n\nimport \"tui-calendar/dist/tui-calendar.css\";\nimport \"tui-date-picker/dist/tui-date-picker.css\";\nimport '../../../assets/css/calendar.css';\nimport \"tui-time-picker/dist/tui-time-picker.css\";\nimport WhiteButton from '../../modules/button/white_button';\n\n// const start = new Date();\n// const end = new Date(new Date().setMinutes(start.getMinutes() + 30));\nconst calendarColor = [\"#ef6f87\",\"#e49d5a\", \"#e4ce5a\", \"#7ddc8b\" ,\"#c0afff\",\"#9fcae8\",\"#F23DA0\", \"#3C5FA6\", \"#F28705\", \"#467326\", \"#D99066\", \"#ff5722\"];\n// const calendarInstructor = [\"#ef6f87\",\"#e49d5a\", \"#2196f3\", \"#7ddc8b\" ,\"#c0afff\",\"#9fcae8\",\"#F23DA0\", \"#3C5FA6\", \"#F28705\", \"#467326\", \"#D99066\", \"#ff5722\"];\n\n\nfunction CommonCalendar(props) {\n    const cal = useRef(null);\n    const [schedules, setschedules] = useState([])\n    const [calendars, setcalendars] = useState([])\n    const [year, setyear] = useState(\"\")\n    const [month, setmonth] = useState(\"\")\n\n    useEffect(() => {\n        if(props.calendarData !== null) {\n            const data = props.calendarData;\n            \n            // var index = 0;\n            var tempSchedule = [];\n            \n            if(props.path !== null && props.path ===\"/admin/academy_date\") {\n                for(var i=0 ; i<data.length ; i++) {\n                    tempSchedule.push({\n                        calendarId: data[i].category_id,\n                        category: \"time\",\n                        isAllDay: true,\n                        isVisible: true,\n                        title: data[i].name,\n                        id: data[i].id,\n                        start: data[i].date,\n                        end: data[i].date\n                    })\n                }\n\n                setschedules(tempSchedule);\n            }\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [props.calendarData])\n\n    useEffect(() => {\n        if(props.categoryData !== null) {\n            var data = props.categoryData;\n            var tempCalendar = [];\n            var index = 0;\n\n            for(var i=0 ; i<data.length ; i++) {\n                tempCalendar.push({\n                    id: data[i].id,\n                    name: data[i].name,\n                    color: calendarColor[index],\n                    bgColor: calendarColor[index]+\"40\",\n                    dragBgColor: calendarColor[index]+\"40\",\n                    borderColor: calendarColor[index]\n                })\n                index++;\n                if(index === calendarColor.length)\n                        index=0;\n            }\n            setcalendars(tempCalendar);\n        }\n        \n    }, [props.categoryData])\n\n\n    useEffect(() => {\n        let today = new Date();   \n        let year = today.getFullYear(); // 년도\n        let month = today.getMonth() + 1;  // 월\n        // let date = today.getDate();  // 날짜\n        // let day = today.getDay();  // 요일\n\n        if(month < 10)\n            month = \"0\"+month;\n        setyear(year)\n        setmonth(month)\n    }, [])\n\n    const onClickSchedule = useCallback((e) => {\n        const { calendarId, id } = e.schedule;\n        cal.current.calendarInst.getElement(id, calendarId);\n\n    }, []);\n\n    const createAcademy = async(data) => {\n        var date = data.start._date\n        var year = date.getFullYear(); \n        var month = date.getMonth() + 1; \n        var day = date.getDate();\n        if(month < 10)\n            month = \"0\"+month;\n        if(day < 10)\n            day = \"0\"+day;\n        var academy_date = year+\"-\"+month+\"-\"+day\n        \n        var addAcademy = {\n            name: data.title,\n            date: academy_date,\n            category_id: data.calendarId,\n            token: window.sessionStorage.getItem('token')\n        }\n        axios(\n            {\n                url: process.env.REACT_APP_RESTAPI_HOST+'academyDate',\n                method: 'post',\n                data: addAcademy\n            }\n        ).then(function(res) {\n            props.readAcademy()\n        })\n    }\n\n    const updateAcademy = async(e) => {\n        const { schedule, changes } = e;\n\n\n        var date = schedule.start._date\n        var changeCategoryId = schedule.calendarId;\n        var changeTitle = schedule.title;\n\n\n        if(changes.hasOwnProperty('start'))\n            date = changes.start._date;\n        if(changes.hasOwnProperty('calendarId'))\n            changeCategoryId = changes.calendarId\n        if(changes.hasOwnProperty('title'))\n            changeTitle = changes.title;\n      \n        var year = date.getFullYear(); \n        var month = date.getMonth() + 1; \n        var day = date.getDate();\n        if(month < 10)\n            month = \"0\"+month;\n        if(day < 10)\n            day = \"0\"+day;\n        var changeDate = year+\"-\"+month+\"-\"+day\n\n        \n        var updateAcademy = {\n            id: schedule.id,\n            name: changeTitle,\n            date: changeDate,\n            category_id: changeCategoryId,\n            token: window.sessionStorage.getItem('token')\n        }\n        axios(\n            {\n                url: process.env.REACT_APP_RESTAPI_HOST+'academyDate',\n                method: 'put',\n                data: updateAcademy\n            }\n        ).then(function(res) {\n            props.readAcademy()\n        })\n    }\n\n    const deleteAcademy = async(id) => {\n        if(window.confirm(\"학사일정을 삭제하시겠습니까?\")) {\n            axios(\n                {\n                    url: process.env.REACT_APP_RESTAPI_HOST+'academyDate',\n                    method: 'delete',\n                    data: {\n                        id: id,\n                        token: window.sessionStorage.getItem('token')\n                    }\n                }\n            ).then(function(res) {\n                props.readAcademy()\n            })\n        }\n    }\n\n    const onBeforeCreateSchedule = useCallback((scheduleData) => {\n        if(window.confirm(\"학사 일정을 추가하시겠습니까?\")) {\n            createAcademy(scheduleData)\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    const onBeforeDeleteSchedule = useCallback((res) => {\n        // eslint-disable-next-line no-unused-vars\n        const { id, calendarId } = res.schedule;\n        deleteAcademy(id);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    const onBeforeUpdateSchedule = useCallback((e) => {\n        if(window.confirm(\"일정을 수정하시겠습니까?\")) {\n            updateAcademy(e)\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    function _getFormattedTime(time) {\n        const date = new Date(time);\n        const h = date.getHours();\n        const m = date.getMinutes();\n\n        return `${h}:${m}`;\n    }\n\n    function _getTimeTemplate(schedule, isAllDay) {\n        var html = [];\n\n        if (!isAllDay) {\n            html.push(\"<strong>\" + _getFormattedTime(schedule.start) + \"</strong> \");\n        }\n        if (schedule.isPrivate) {\n            html.push('<span class=\"calendar-font-icon ic-lock-b\"></span>');\n            html.push(\" Private\");\n        } else {\n            if (schedule.isReadOnly) {\n                html.push('<span class=\"calendar-font-icon ic-readonly-b\"></span>');\n            } else if (schedule.recurrenceRule) {\n                html.push('<span class=\"calendar-font-icon ic-repeat-b\"></span>');\n            } else if (schedule.attendees.length) {\n                html.push('<span class=\"calendar-font-icon ic-user-b\"></span>');\n            } else if (schedule.location) {\n                html.push('<span class=\"calendar-font-icon ic-location-b\"></span>');\n            }\n            html.push(\" \" + schedule.title);\n        }\n\n        return html.join(\"\");\n    }\n\n    const templates = {\n        time: function (schedule) {\n            return _getTimeTemplate(schedule, false);\n        }\n    };\n\n    const NextButton = useCallback((e) => {\n        if (cal !== null) {\n            const calendarInstance = cal.current.getInstance();\n            calendarInstance.next();\n            var m = calendarInstance.getDate().getMonth() + 1;\n            var y = calendarInstance.getDate().getFullYear();\n            if(m < 10)\n                m = \"0\"+m;\n            // var date = y+\"-\"+m;\n\n            setmonth(m);\n            setyear(y)\n        }\n    }, []);\n\n    const PrevButton = useCallback((e) => {\n\n        if (cal !== null) {\n            const calendarInstance = cal.current.getInstance();\n            calendarInstance.prev();\n            var m = calendarInstance.getDate().getMonth() + 1;\n            var y = calendarInstance.getDate().getFullYear();\n            if(m < 10)\n                m = \"0\"+m;\n            // var date = y+\"-\"+m;\n\n            setmonth(m);\n            setyear(y)\n\n            // props.readMainCalendar(date)\n        }\n\n        \n    }, []);\n\n    const TodayButton = useCallback((e) => {\n        if (cal !== null) {\n        const calendarInstance = cal.current.getInstance();\n        calendarInstance.today();\n        var m = calendarInstance.getDate().getMonth() + 1;\n        var y = calendarInstance.getDate().getFullYear();\n        if(m < 10)\n            m = \"0\"+m;\n        // var date = y+\"-\"+m;\n\n        setmonth(m);\n        setyear(y)\n        }\n    }, []);\n\n    return (\n        <div>\n        <h2 className=\"calendar-title\">{year}년 {month}월의 학사일정</h2>\n            <div className=\"mb15\">\n                <WhiteButton class=\"mr15\" name=\"오늘날짜\" click={TodayButton}/>\n                <WhiteButton class=\"mr15\" name=\"<\" click={PrevButton}/>\n                <WhiteButton name=\">\" click={NextButton}/>\n            </div>\n\n            <div style={{textAlign:\"right\", marginBottom:\"15px\"}}>\n                {props.categoryData !== null ? \n                props.categoryData.map((category, index) => {\n                    return <span key={category.id} className=\"mr15\">\n                                <span className=\"color-circle\" style={{background:calendarColor[index]}}></span>\n                                <span>{category.name}</span>\n                            </span>\n                }):\n                null\n                }\n            </div>\n            \n            <TUICalendar\n                ref={cal}\n                height=\"100%\"\n                view=\"month\"\n                useCreationPopup={true}\n                useDetailPopup={true}\n                template={templates}\n                calendars={calendars}\n                schedules={schedules}\n                onClickSchedule={onClickSchedule}\n                onBeforeCreateSchedule={onBeforeCreateSchedule}\n                onBeforeDeleteSchedule={onBeforeDeleteSchedule}\n                onBeforeUpdateSchedule={onBeforeUpdateSchedule}\n            />\n        </div>\n    );\n}\n\nexport default CommonCalendar;"]},"metadata":{},"sourceType":"module"}