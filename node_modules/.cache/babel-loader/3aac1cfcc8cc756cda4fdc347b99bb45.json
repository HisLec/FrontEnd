{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from'axios';import XLSX from\"xlsx\";import FileSaver from\"file-saver\";import GreyButton from'../../modules/button/admin_grey_btn';import WhiteButton from'../../modules/button/white_button';import CommonModal from'../../modules/modal/common';import Calendar from'../../modules/calendar/crud_calendar';import'../../../assets/css/academyDate.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AdminAcademyDate(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalOpen=_useState2[0],setModalOpen=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),academyInfo=_useState4[0],setacademyInfo=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),categoryInfo=_useState6[0],setcategoryInfo=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),selectCategory=_useState8[0],setselectCategory=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),addName=_useState10[0],setaddName=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),isAdd=_useState12[0],setisAdd=_useState12[1];var _useState13=useState(null),_useState14=_slicedToArray(_useState13,2),previousAcademyInfo=_useState14[0],setpreviousAcademyInfo=_useState14[1];var array=null;// excel upload\nvar _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),excelJSONData=_useState16[0],setExcelJSONData=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),errorCount=_useState18[0],seterrorCount=_useState18[1];var excelFormat={name:\"일정명 (필수)\",date:\"날짜(2021-00-00 형식으로) (필수)\",category:\"분류(비전, 교육, 책임, 심리, 육아, 상담, 성경, 관계 중) -> 여러개 입력 시 , 로 연결해주세요 (육아,상담,성경 의 형식으로) (필수)\"};useEffect(function(){readAcademy();readCategory();previousYearAcademy();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);useEffect(function(){if(excelJSONData!==null){var count=0;excelJSONData.forEach(function(data){if(data.isValid===false)count++;});seterrorCount(count);}},[excelJSONData]);var openModal=function openModal(){// document.getElementById('upload').click()\nsetModalOpen(true);};var closeModal=function closeModal(){setModalOpen(false);};var clickCategory=function clickCategory(category){array=selectCategory;var check=0;for(var i=0;i<array.length;i++){if(array[i]===category.id){var idx=array.findIndex(function(item){return item===category.id;});if(idx>-1)array.splice(idx,1);check=1;break;}}if(check===0){array.push(category.id);}readAcademy(array);setselectCategory(array);};var readAcademy=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(ids){var i,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:ids=\"\";for(i=0;i<selectCategory.length;i++){ids+=selectCategory[i];if(i<selectCategory.length-1)ids+=\",\";}if(selectCategory.length===0)ids=null;_context.next=5;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'academyDate',{params:{category:ids,token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 5:response=_context.sent;setacademyInfo(response.data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function readAcademy(_x){return _ref.apply(this,arguments);};}();var previousYearAcademy=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'academyDate/previous',{params:{token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 2:response=_context2.sent;setpreviousAcademyInfo(response.data);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function previousYearAcademy(){return _ref2.apply(this,arguments);};}();function readExcel(event){seterrorCount(0);var input=event.target;var reader=new FileReader();reader.onload=function(){var data=reader.result;var workBook=XLSX.read(data,{type:'binary'});workBook.SheetNames.forEach(function(sheetName){var rows=XLSX.utils.sheet_to_json(workBook.Sheets[sheetName]);var changedData=[];rows.forEach(function(data){var temp=data;if(!temp.hasOwnProperty('date')||!temp.hasOwnProperty('name')||!temp.hasOwnProperty('category_name')){temp.isValid=false;}else{temp.isValid=true;}changedData.push(temp);});setExcelJSONData(changedData);});};if(input.files[0]!==undefined){reader.readAsBinaryString(input.files[0]);openModal();event.target.value=null;}}var uploadExcelFile=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var params;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:// console.log(excelJSONData);\nparams=new URLSearchParams();params.append('data',JSON.stringify(excelJSONData));params.append('token',window.sessionStorage.getItem('token'));params.append('manageID',window.sessionStorage.getItem('id'));if(!window.confirm(\"학사일정을 업로드하시겠습니까?\")){_context3.next=7;break;}_context3.next=7;return axios.post(process.env.REACT_APP_RESTAPI_HOST+'academyDate/excel',params).then(function(res){alert(\"엑셀 업로드가 완료되었습니다!\");setModalOpen(false);readAcademy();setExcelJSONData(null);});case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function uploadExcelFile(){return _ref3.apply(this,arguments);};}();var readCategory=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'academyDate/category',{params:{token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 2:response=_context4.sent;setcategoryInfo(response.data);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function readCategory(){return _ref4.apply(this,arguments);};}();var exportToCSV=function exportToCSV(){var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var fileName=\"academy_date\";var ws=XLSX.utils.json_to_sheet(academyInfo);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};var exportExcelForamt=function exportExcelForamt(){var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var fileName=\"academy_date_format\";var ws=XLSX.utils.json_to_sheet(excelFormat);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};var exportToCSVPreviousYear=function exportToCSVPreviousYear(){var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var fileName=\"previous_academy_date\";var ws=XLSX.utils.json_to_sheet(previousAcademyInfo);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};var clickAddBtn=function clickAddBtn(){setaddName(\"\");if(isAdd)setisAdd(false);else setisAdd(true);};var addCategory=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var params;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:params=new URLSearchParams();params.append('name',addName);params.append('token',window.sessionStorage.getItem('token'));params.append('manageID',window.sessionStorage.getItem('id'));if(!window.confirm(\"카테고리를 추가하시겠습니까?\")){_context5.next=7;break;}_context5.next=7;return axios.post(process.env.REACT_APP_RESTAPI_HOST+'academyDate/category',params).then(function(res){alert(\"카테고리가 추가되었습니다.\");readCategory();setisAdd(false);setaddName(\"\");});case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function addCategory(){return _ref5.apply(this,arguments);};}();var deleteCategory=function deleteCategory(id){if(window.confirm(\"카테고리와 연관된 모든 일정이 함께 삭제됩니다. 카테고리를 삭제하시겠습니까?\")){axios({url:process.env.REACT_APP_RESTAPI_HOST+'academyDate/category',method:'delete',data:{id:id,token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}}).then(function(res){alert(\"삭제가 완료되었습니다.\");readCategory();readAcademy();});}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"admin-title-header\",children:\"\\uD559\\uC0AC\\uC77C\\uC815 \\uAD00\\uB9AC\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content-wrapper\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"table-name mb40\",children:[\"\\uD559\\uC0AC\\uC77C\\uC815 \\uAD00\\uB9AC\",/*#__PURE__*/_jsx(GreyButton,{class:\"none-buttoon right\",name:\"\\uD559\\uC0AC \\uC77C\\uC815 \\uB2E4\\uC6B4\\uB85C\\uB4DC\",click:exportToCSV}),/*#__PURE__*/_jsx(GreyButton,{class:\"none-buttoon right mr10\",name:\"\\uC5C5\\uB85C\\uB4DC \\uD3EC\\uB9F7 \\uB2E4\\uC6B4\",click:exportExcelForamt}),/*#__PURE__*/_jsx(GreyButton,{class:\"none-buttoon right mr10\",name:\"\\uC804\\uB144\\uB3C4 \\uD559\\uC0AC \\uC77C\\uC815 \\uAC00\\uC838\\uC624\\uAE30\",click:exportToCSVPreviousYear}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\".xlsx\",onChange:readExcel,id:\"uploadExcel\",name:\"uploadExcel\",style:{display:'none'}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"uploadExcel\",className:\"grey-btn\",children:\"\\uC77C\\uC815 \\uD30C\\uC77C \\uC5C5\\uB85C\\uB4DC\"})]}),/*#__PURE__*/_jsxs(CommonModal,{open:modalOpen,close:closeModal,func:uploadExcelFile,header:\"\\uC77C\\uC815 \\uC5C5\\uB85C\\uB4DC \\uBAA9\\uB85D\",footer:\"\\uB370\\uC774\\uD130 \\uC800\\uC7A5\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"mb20\",children:[\"\\uBE68\\uAC04 \\uC0C9\\uC73C\\uB85C \\uD45C\\uC2DC\\uB41C \\uAC83\\uC740 \\uC5C5\\uB85C\\uB4DC \\uD560 \\uC218 \\uC5C6\\uB294 \\uB370\\uC774\\uD130\\uC785\\uB2C8\\uB2E4. \\uBE7C\\uACE0 \\uC5C5\\uB85C\\uB4DC\\uB97C \\uC9C4\\uD589\\uD560\\uAE4C\\uC694?\",/*#__PURE__*/_jsx(\"br\",{}),\"\\uD604\\uC7AC \\uC798\\uBABB\\uB41C \\uB370\\uC774\\uD130\\uB294 \",errorCount,\"\\uAC1C \\uC785\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-wrapper mt0 relative modal-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-row-academy\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"th\",children:\"\\uC77C\\uC815 \\uC774\\uB984\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th\",children:\"\\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th\",children:\"\\uCE74\\uD14C\\uACE0\\uB9AC\"})]}),excelJSONData!==null?excelJSONData.map(function(data,i){return/*#__PURE__*/_jsxs(\"div\",{className:data.isValid?\"table-row-academy\":\"table-row-academy modal-error\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:data.name}),/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:data.date}),/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:data.category_name})]},i);}):/*#__PURE__*/_jsx(\"div\",{children:\"\\uC5D1\\uC140 \\uB370\\uC774\\uD130\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"academy-wrapper\",children:[/*#__PURE__*/_jsx(\"div\",{style:{padding:\"15px\"},children:/*#__PURE__*/_jsx(Calendar,{readAcademy:readAcademy,calendarData:academyInfo,categoryData:categoryInfo,path:window.location.href.replace(process.env.REACT_APP_DEFAULT_WHOLE_URL,\"/\")})}),/*#__PURE__*/_jsxs(\"div\",{className:\"academy-category\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"academy-category-title\",children:\"\\uCE74\\uD14C\\uACE0\\uB9AC\\uBCC4\\uB85C \\uBCF4\\uAE30 (\\uC911\\uBCF5 \\uC120\\uD0DD \\uAC00\\uB2A5)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"academy-category-content\",children:[categoryInfo!==null?categoryInfo.map(function(category,index){return/*#__PURE__*/_jsxs(\"span\",{className:\"academyDate-category\",style:{position:'relative',padding:'9px 5px'},children:[/*#__PURE__*/_jsx(WhiteButton,{name:category.name,class:selectCategory.find(function(element){return element===category.id;})?\"clicked-category mb10\":\"mb10\",click:function click(){return clickCategory(category);}}),/*#__PURE__*/_jsx(\"span\",{className:\"delete-category-btn\",onClick:function onClick(){return deleteCategory(category.id);},children:\"X\"})]},category.id);}):/*#__PURE__*/_jsx(\"div\",{children:\"\\uCE74\\uD14C\\uACE0\\uB9AC\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}),/*#__PURE__*/_jsx(WhiteButton,{name:\"\\uCE74\\uD14C\\uACE0\\uB9AC \\uCD94\\uAC00\",class:isAdd?\"clicked-category\":\"\",click:function click(){return clickAddBtn();}})]}),isAdd?/*#__PURE__*/_jsxs(\"div\",{style:{padding:\"8px\"},children:[/*#__PURE__*/_jsx(\"input\",{className:\"categoryAddInput\",defaultValue:addName,onChange:function onChange(e){return setaddName(e.target.value);}}),/*#__PURE__*/_jsx(GreyButton,{class:\"categoryAddBtn\",name:\"\\uCD94\\uAC00\",click:addCategory})]}):null]})]})]})]});}export default AdminAcademyDate;","map":{"version":3,"sources":["/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/src/components/pages/admin/academyDate.js"],"names":["React","useState","useEffect","axios","XLSX","FileSaver","GreyButton","WhiteButton","CommonModal","Calendar","AdminAcademyDate","props","modalOpen","setModalOpen","academyInfo","setacademyInfo","categoryInfo","setcategoryInfo","selectCategory","setselectCategory","addName","setaddName","isAdd","setisAdd","previousAcademyInfo","setpreviousAcademyInfo","array","excelJSONData","setExcelJSONData","errorCount","seterrorCount","excelFormat","name","date","category","readAcademy","readCategory","previousYearAcademy","count","forEach","data","isValid","openModal","closeModal","clickCategory","check","i","length","id","idx","findIndex","item","splice","push","ids","get","process","env","REACT_APP_RESTAPI_HOST","params","token","window","sessionStorage","getItem","manageID","response","readExcel","event","input","target","reader","FileReader","onload","result","workBook","read","type","SheetNames","sheetName","rows","utils","sheet_to_json","Sheets","changedData","temp","hasOwnProperty","files","undefined","readAsBinaryString","value","uploadExcelFile","URLSearchParams","append","JSON","stringify","confirm","post","then","res","alert","exportToCSV","fileType","fileExtension","fileName","ws","json_to_sheet","wb","excelBuffer","write","bookType","Blob","saveAs","exportExcelForamt","exportToCSVPreviousYear","clickAddBtn","addCategory","deleteCategory","url","method","display","map","category_name","padding","location","href","replace","REACT_APP_DEFAULT_WHOLE_URL","index","position","find","element","e"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport axios from 'axios';\nimport XLSX from \"xlsx\";\nimport FileSaver from \"file-saver\";\n\nimport GreyButton from '../../modules/button/admin_grey_btn';\nimport WhiteButton from '../../modules/button/white_button';\nimport CommonModal from '../../modules/modal/common';\nimport Calendar from '../../modules/calendar/crud_calendar';\n\nimport '../../../assets/css/academyDate.css'\n\nfunction AdminAcademyDate(props) {\n    const [ modalOpen, setModalOpen ] = useState(false);\n    const [academyInfo, setacademyInfo] = useState(null);\n    const [categoryInfo, setcategoryInfo] = useState(null);\n    const [selectCategory, setselectCategory] = useState([]);\n    const [addName, setaddName] = useState(\"\");\n    const [isAdd, setisAdd] = useState(false);\n    const [previousAcademyInfo, setpreviousAcademyInfo] = useState(null)\n    var array = null;\n \n    // excel upload\n    const [excelJSONData, setExcelJSONData] = useState(null);\n    const [errorCount, seterrorCount] = useState(0);\n    const excelFormat = {name:\"일정명 (필수)\", date:\"날짜(2021-00-00 형식으로) (필수)\", category:\"분류(비전, 교육, 책임, 심리, 육아, 상담, 성경, 관계 중) -> 여러개 입력 시 , 로 연결해주세요 (육아,상담,성경 의 형식으로) (필수)\" };\n\n    useEffect(() => {\n        readAcademy();\n        readCategory();\n        previousYearAcademy();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    useEffect(() => {\n        if(excelJSONData !== null) {\n            var count = 0;\n            excelJSONData.forEach(data => {\n                if(data.isValid === false)\n                    count++;\n            });\n            seterrorCount(count);\n        }\n    }, [excelJSONData])\n\n\n    const openModal = () => {\n        // document.getElementById('upload').click()\n\n        setModalOpen(true);\n    }\n    const closeModal = () => {\n        setModalOpen(false);\n    }\n\n    const clickCategory = (category) => {\n        array = selectCategory;\n        var check = 0;\n        for(var i=0 ; i<array.length ; i++) {\n            if(array[i] === category.id) {\n                const idx = array.findIndex(function(item) {return item === category.id})\n                if (idx > -1) array.splice(idx, 1)\n                check=1;\n                break;\n            }\n        }\n        if(check===0) {\n            array.push(category.id)\n        }\n\n        readAcademy(array)\n        setselectCategory(array)\n        \n    }\n\n    const readAcademy = async(ids) => {\n        ids=\"\";\n        \n        for(var i=0 ; i<selectCategory.length ; i++) {\n            ids += selectCategory[i];\n            if(i<selectCategory.length-1)\n                ids += \",\";\n        }\n        if(selectCategory.length === 0)\n            ids = null;\n            \n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'academyDate', {\n                params:{\n                    category: ids,\n                    token: window.sessionStorage.getItem('token'),\n                    manageID: window.sessionStorage.getItem('id')\n                }\n            }\n        );\n        setacademyInfo(response.data)  \n    }\n\n    const previousYearAcademy = async () => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'academyDate/previous', {\n                params: {\n                    token: window.sessionStorage.getItem('token'),\n                    manageID: window.sessionStorage.getItem('id')\n                }\n            }\n        );\n        setpreviousAcademyInfo(response.data);\n    }\n\n    function readExcel(event) {\n        seterrorCount(0);\n        let input = event.target;\n        let reader = new FileReader();\n        reader.onload = function () {\n            let data = reader.result;\n            let workBook = XLSX.read(data, { type: 'binary' });\n            workBook.SheetNames.forEach(function (sheetName) {\n                let rows = XLSX.utils.sheet_to_json(workBook.Sheets[sheetName]);\n                var changedData = [];\n                rows.forEach(data => {\n                    var temp = data;\n                    \n                    if(!temp.hasOwnProperty('date') || !temp.hasOwnProperty('name') || !temp.hasOwnProperty('category_name')) {\n                        temp.isValid = false;\n                    } else {\n                        temp.isValid = true;\n                    }\n                    changedData.push(temp);\n                });\n                setExcelJSONData(changedData);\n            })\n        };\n        if(input.files[0] !== undefined) {\n            reader.readAsBinaryString(input.files[0]);\n            openModal();\n            event.target.value = null;\n        }\n    }\n\n    const uploadExcelFile = async () => {\n        // console.log(excelJSONData);\n        var params = new URLSearchParams();\n        params.append('data', JSON.stringify(excelJSONData));\n        params.append('token', window.sessionStorage.getItem('token'));\n        params.append('manageID', window.sessionStorage.getItem('id'));\n\n        if(window.confirm(\"학사일정을 업로드하시겠습니까?\")) {\n            await axios.post(\n            process.env.REACT_APP_RESTAPI_HOST + 'academyDate/excel',\n            params,\n            ).then(function(res) {\n                alert(\"엑셀 업로드가 완료되었습니다!\");\n                setModalOpen(false);\n                readAcademy();\n                setExcelJSONData(null);\n            });\n        }\n    }\n\n    const readCategory = async() => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'academyDate/category', {\n                params: {\n                    token: window.sessionStorage.getItem('token'),\n                    manageID: window.sessionStorage.getItem('id')\n                }\n            }\n        );\n        setcategoryInfo(response.data);\n    }\n\n    const exportToCSV = () => {\n        const fileType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n        const fileExtension = \".xlsx\";\n        const fileName = \"academy_date\";\n        const ws = XLSX.utils.json_to_sheet(academyInfo);\n        const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n        const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, fileName + fileExtension);\n    };\n\n    const exportExcelForamt = () => {\n        const fileType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n        const fileExtension = \".xlsx\";\n        const fileName = \"academy_date_format\";\n        const ws = XLSX.utils.json_to_sheet(excelFormat);\n        const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n        const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, fileName + fileExtension);\n    }\n\n    const exportToCSVPreviousYear = () => {\n        const fileType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n        const fileExtension = \".xlsx\";\n        const fileName = \"previous_academy_date\";\n        const ws = XLSX.utils.json_to_sheet(previousAcademyInfo);\n        const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n        const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, fileName + fileExtension);\n    };\n\n    const clickAddBtn = () => {\n        setaddName(\"\");\n        if(isAdd)\n            setisAdd(false);\n        else\n            setisAdd(true);\n    }\n\n    const addCategory = async () => {\n        var params = new URLSearchParams();\n        params.append('name', addName);\n        params.append('token', window.sessionStorage.getItem('token'));\n        params.append('manageID', window.sessionStorage.getItem('id'));\n\n        if(window.confirm(\"카테고리를 추가하시겠습니까?\")) {\n            await axios.post(\n            process.env.REACT_APP_RESTAPI_HOST + 'academyDate/category', \n            params,\n            ).then(function(res) {\n                alert(\"카테고리가 추가되었습니다.\");\n                readCategory();\n                setisAdd(false);\n                setaddName(\"\");\n            });\n        }\n    }\n\n    const deleteCategory = (id) => {\n        if(window.confirm(\"카테고리와 연관된 모든 일정이 함께 삭제됩니다. 카테고리를 삭제하시겠습니까?\")) {\n            axios(\n                {\n                    url: process.env.REACT_APP_RESTAPI_HOST+'academyDate/category',\n                    method: 'delete',\n                    data: {\n                        id: id,\n                        token: window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            ).then(function(res) {\n                alert(\"삭제가 완료되었습니다.\")\n                readCategory();\n                readAcademy();\n            })\n        }\n    }\n\n    return (\n        <div>\n            <p className=\"admin-title-header\">학사일정 관리</p>\n            <div className=\"admin-content-wrapper\">\n                <p className=\"table-name mb40\">\n                    학사일정 관리\n                    <GreyButton class=\"none-buttoon right\" name=\"학사 일정 다운로드\" click={exportToCSV}/>\n                    <GreyButton class=\"none-buttoon right mr10\" name=\"업로드 포맷 다운\" click={exportExcelForamt}/>\n                    <GreyButton class=\"none-buttoon right mr10\" name=\"전년도 학사 일정 가져오기\" click={exportToCSVPreviousYear}/>\n                    <input\n                        type='file'\n                        accept='.xlsx'\n                        onChange={readExcel}\n                        id='uploadExcel'\n                        name='uploadExcel'\n                        style={{ display: 'none' }}\n                    />\n                    <label htmlFor='uploadExcel' className=\"grey-btn\">\n                        일정 파일 업로드\n                    </label>\n                </p>\n                <CommonModal open={modalOpen} close={closeModal} func={uploadExcelFile} header=\"일정 업로드 목록\" footer=\"데이터 저장\">\n                    <p className=\"mb20\">\n                        빨간 색으로 표시된 것은 업로드 할 수 없는 데이터입니다. 빼고 업로드를 진행할까요?<br/>\n                        현재 잘못된 데이터는 {errorCount}개 입니다.\n                    </p>\n                    \n                    <div className=\"table-wrapper mt0 relative modal-table\">\n                        <div className=\"table-row-academy\" >\n                            <span className=\"th\">일정 이름</span>\n                            <span className=\"th\">날짜</span>\n                            <span className=\"th\">카테고리</span>\n                        </div>\n                        {excelJSONData !== null ?\n                        excelJSONData.map((data, i) =>\n                        <div key={i} className={data.isValid ? \"table-row-academy\" : \"table-row-academy modal-error\"}>\n                            <span className=\"td\">{data.name}</span>\n                            <span className=\"td\">{data.date}</span>\n                            <span className=\"td\">{data.category_name}</span>\n                        </div>\n                        )\n                        :\n                        <div>엑셀 데이터가 없습니다.</div>\n                        }\n                        \n                    </div>\n                </CommonModal>\n                <div className=\"academy-wrapper\">\n                    <div style={{padding:\"15px\"}}>\n                        <Calendar readAcademy={readAcademy} calendarData = {academyInfo} categoryData={categoryInfo} path={window.location.href.replace(process.env.REACT_APP_DEFAULT_WHOLE_URL, \"/\")}/>\n                    </div>\n                    <div className=\"academy-category\">\n                        <div className=\"academy-category-title\">\n                            카테고리별로 보기 (중복 선택 가능)\n                        </div>\n                        <div className=\"academy-category-content\">                            \n                            { categoryInfo !== null ?\n                                categoryInfo.map((category, index) => \n                                <span key={category.id} className=\"academyDate-category\" style={{position:'relative', padding:'9px 5px'}}>\n                                    <WhiteButton \n                                    name={category.name}\n                                    class={selectCategory.find(element => element === category.id) ? \"clicked-category mb10\" : \"mb10\"} \n                                    click={() => clickCategory(category)}/>\n                                    <span className=\"delete-category-btn\" onClick={() => deleteCategory(category.id)}>X</span>\n                                </span>\n                                )\n                                :\n                                <div>카테고리가 없습니다.</div>\n                            }\n                            <WhiteButton name=\"카테고리 추가\" class={isAdd ? \"clicked-category\" : \"\"} click={() => clickAddBtn()}/>\n                        </div>\n                        {isAdd?\n                        <div style={{padding:\"8px\"}}>\n                            <input className=\"categoryAddInput\" defaultValue={addName} onChange={(e)=>setaddName(e.target.value)}/>\n                            <GreyButton class=\"categoryAddBtn\" name=\"추가\" click={addCategory}/>\n                        </div>\n                        :\n                        null\n                        }\n                    </div>\n                </div>\n            </div>\n        </div>\n        )\n}\n\nexport default AdminAcademyDate;"]},"metadata":{},"sourceType":"module"}