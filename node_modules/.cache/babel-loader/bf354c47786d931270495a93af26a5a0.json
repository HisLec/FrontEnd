{"ast":null,"code":"var _jsxFileName = \"/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/src/components/pages/mypage/visitDiary.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { RMIUploader } from \"react-multiple-image-uploader\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ReactLoading from \"react-loading\";\nimport Pagination from \"react-js-pagination\";\nimport '../../../assets/css/table.css';\nimport '../../../assets/css/Contact.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst VisitDiary = props => {\n  _s();\n\n  const [applicationInfo, setapplicationInfo] = useState(null);\n  const [selectedLecture, setSelectedLecture] = useState(null);\n  const [visitingLogFileData, setVisitingLogFileData] = useState([]);\n  const [visitingLogContent, setVisitingLogContent] = useState(null);\n  const [visible, setVisible] = useState(false);\n  const [page, setPage] = useState(1); // eslint-disable-next-line no-unused-vars\n\n  const [postsPerPage, setpostsPerPage] = useState(10);\n  const [settingInfo, setsettingInfo] = useState(null);\n  var visitingLogFile = [];\n  useEffect(() => {\n    readApplicationForms();\n    readSettingInfo();\n  }, []);\n\n  const readSettingInfo = async () => {\n    const response = await axios.get(process.env.REACT_APP_RESTAPI_HOST + 'setting', {\n      params: {\n        token: window.sessionStorage.getItem('token'),\n        manageID: window.sessionStorage.getItem('id')\n      }\n    });\n    setsettingInfo(response.data);\n  };\n\n  const selectButton = async data => {\n    if (selectedLecture === null || selectedLecture !== data) {\n      if (data.visit_reg_date !== null) {\n        const response = await axios.get(process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/file/' + data.feedback_id, {\n          params: {\n            token: window.sessionStorage.getItem('token'),\n            manageID: window.sessionStorage.getItem('id')\n          }\n        });\n        setVisitingLogFileData(response.data);\n      }\n\n      setSelectedLecture(data);\n    } else {\n      setSelectedLecture(null);\n    }\n  };\n\n  const readApplicationForms = async () => {\n    const response = await axios.get(process.env.REACT_APP_RESTAPI_HOST + 'application/instructor/' + window.sessionStorage.getItem('id'), {\n      params: {\n        token: window.sessionStorage.getItem('token'),\n        manageID: window.sessionStorage.getItem('id')\n      }\n    });\n    setapplicationInfo(response.data);\n  };\n\n  const hideModal = () => {\n    setVisible(false);\n  };\n\n  const onUpload = data => {\n    visitingLogFile = data;\n  };\n\n  const onSelect = data => {};\n\n  const onRemove = id => {};\n\n  const insertVisitingLog = async () => {\n    if (window.confirm(\"방문일지를 저장하시겠습니까?\")) {\n      document.getElementsByClassName(\"ant-btn-icon-only\")[1].click(); //document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n      //const blob = await fetch(base64).then(res => res.blob());\n\n      const params = new FormData();\n      const headers = {\n        'Content-type': 'multipart/form-data; charset=UTF-8',\n        'Accept': '*/*'\n      }; //var params = new URLSearchParams();\n\n      params.append('content', visitingLogContent);\n\n      for (var i = 0; i < visitingLogFile.length; i++) {\n        params.append('file', visitingLogFile[i].file);\n      }\n\n      params.append('token', window.sessionStorage.getItem('token'));\n      params.append('manageID', window.sessionStorage.getItem('id'));\n      await axios.post(process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/application_form/' + selectedLecture.id, //[loginID]로그인 후 변경\n      params, {\n        headers\n      }).then(function (res) {\n        alert(\"방문일지가 저장되었습니다.\");\n        readApplicationForms();\n        setSelectedLecture(null);\n      });\n    }\n  };\n\n  const deleteButton = async data => {\n    console.log(selectedLecture);\n\n    if (window.confirm(\"방문일지를 삭제하시겠습니까?\")) {\n      axios({\n        url: process.env.REACT_APP_RESTAPI_HOST + 'visiting_log',\n        method: 'delete',\n        data: {\n          id: selectedLecture.feedback_id,\n          application_form_id: selectedLecture.id,\n          token: window.sessionStorage.getItem('token'),\n          manageID: window.sessionStorage.getItem('id')\n        }\n      }).then(function (res) {\n        alert(\"삭제가 완료되었습니다.\");\n        readApplicationForms();\n        setSelectedLecture(null);\n      });\n    }\n  };\n\n  const handlePageChange = page => {\n    setPage(page);\n  };\n\n  function currentPosts(tmp) {\n    var indexOfLast = page * postsPerPage;\n    var indexOfFirst = indexOfLast - postsPerPage;\n    let currentPosts = 0;\n    currentPosts = applicationInfo.slice(indexOfFirst, indexOfLast);\n    return currentPosts;\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mypage-image\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"page-background\",\n        src: process.env.REACT_APP_DEFAULT_URL + 'image/application.jpeg',\n        alt: \"lecture page\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"page-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: 'black'\n          },\n          children: settingInfo !== null ? settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: item\n          }, i, false, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 131\n          }, this)) : \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"inst-title-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        style: {\n          color: 'white'\n        },\n        children: \"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: settingInfo !== null ? settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          children: item\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 127\n        }, this)) : \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"content-wrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"left-navbar\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            className: props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL + \"mypage/profile\" ? \"left-active\" : \"\",\n            to: process.env.REACT_APP_DEFAULT_URL + \"mypage/profile\",\n            children: \"\\uB0B4 \\uD504\\uB85C\\uD544\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            className: props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL + \"mypage/lecture\" ? \"left-active\" : \"\",\n            to: process.env.REACT_APP_DEFAULT_URL + \"mypage/lecture\",\n            children: \"\\uB0B4 \\uAC15\\uC758\\uD568\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            className: props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL + \"mypage/contact\" ? \"left-active\" : \"\",\n            to: process.env.REACT_APP_DEFAULT_URL + \"mypage/contact\",\n            children: \"\\uCEE8\\uD0DD \\uC77C\\uC815\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            className: props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL + \"mypage/visitlog\" ? \"left-active\" : \"\",\n            to: process.env.REACT_APP_DEFAULT_URL + \"mypage/visitlog\",\n            children: \"\\uBC29\\uBB38\\uC77C\\uC9C0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"right-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"table-row-visit\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"th visit-index\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"th\",\n              children: \"\\uBC29\\uBB38\\uD55C \\uAD50\\uD68C\\uBA85\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"th visit-date\",\n              children: \"\\uB2E4\\uB140\\uC628 \\uB0A0\\uC9DC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"th\",\n              children: \"\\uC77C\\uC9C0 \\uC791\\uC131\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }, this), applicationInfo !== null && applicationInfo.length >= 1 ? currentPosts(applicationInfo).map((data, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: selectedLecture !== null && selectedLecture.id === data.id ? \"click-inst-row table-row-visit\" : \"table-row-visit\",\n            onClick: () => {\n              selectButton(data);\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"td visit-index\",\n              children: index + 1 + (page - 1) * postsPerPage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"td\",\n              children: data.church_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"td visit-date\",\n              children: data.date\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 200,\n              columnNumber: 37\n            }, this), data.visit_reg_date !== null ? /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"td\",\n              children: \"\\uD53C\\uB4DC\\uBC31 \\uC644\\uB8CC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 41\n            }, this) : /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"td\",\n              children: \"\\uD53C\\uB4DC\\uBC31 \\uBBF8\\uC644\\uB8CC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 42\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 33\n          }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"no-content\",\n            children: \"\\uC2E0\\uCCAD\\uC11C\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Pagination, {\n          activePage: page,\n          itemsCountPerPage: postsPerPage,\n          totalItemsCount: applicationInfo !== null ? applicationInfo.length : 0,\n          pageRangeDisplayed: 5,\n          prevPageText: \"‹\",\n          nextPageText: \"›\",\n          onChange: handlePageChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 21\n        }, this), selectedLecture !== null && selectedLecture.visit_reg_date !== null ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"show-lecture-detail\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"regular\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"bold\",\n              children: selectedLecture.lecture_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 223,\n              columnNumber: 56\n            }, this), \"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"feedback-detail-content\",\n            children: selectedLecture.visit_log.split(\"\\n\").map((item, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n              children: item\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 129\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"feedback-image-swiper-wrapper\",\n            children: /*#__PURE__*/_jsxDEV(Swiper, {\n              spaceBetween: 30,\n              effect: 'fade',\n              centeredSlides: true,\n              loop: true,\n              loopFillGroupWithBlank: true,\n              pagination: {\n                \"clickable\": true\n              },\n              navigation: true,\n              className: \"feedback-swiper\",\n              children: visitingLogFileData !== null ? visitingLogFileData.map((data, index) => /*#__PURE__*/_jsxDEV(SwiperSlide, {\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"feedback-image-wrapper\",\n                  children: /*#__PURE__*/_jsxDEV(\"img\", {\n                    src: process.env.REACT_APP_RESTAPI_HOST + \"resources/upload/\" + data,\n                    alt: \"uploadFile\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 239,\n                    columnNumber: 97\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 239,\n                  columnNumber: 57\n                }, this)\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 53\n              }, this)) : /*#__PURE__*/_jsxDEV(ReactLoading, {\n                type: \"spin\",\n                color: \"#05589c\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 51\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"feedback-submit\",\n            onClick: deleteButton,\n            children: \"\\uC0AD\\uC81C\\uD558\\uAE30\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 29\n        }, this) : selectedLecture !== null && selectedLecture.status === 2 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"show-lecture-detail\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"regular\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"bold\",\n              children: selectedLecture.lecture_name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 56\n            }, this), \"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            className: \"feedback-textarea\",\n            placeholder: \"\\uAE00 \\uB0A8\\uAE30\\uAE30\",\n            onChange: e => {\n              setVisitingLogContent(e.target.value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(RMIUploader, {\n            isOpen: visible,\n            hideModal: hideModal,\n            onSelect: onSelect,\n            onUpload: onUpload,\n            onRemove: onRemove,\n            dataSources: []\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"feedback-submit\",\n            onClick: () => insertVisitingLog(),\n            children: \"\\uC791\\uC131 \\uC644\\uB8CC\\uD558\\uAE30\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 29\n        }, this) : null]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 9\n  }, this);\n};\n\n_s(VisitDiary, \"IzRHwI1VsPeoGd8Uf5Ig5lop94c=\");\n\n_c = VisitDiary;\nexport default VisitDiary;\n\nvar _c;\n\n$RefreshReg$(_c, \"VisitDiary\");","map":{"version":3,"sources":["/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/src/components/pages/mypage/visitDiary.js"],"names":["React","useState","useEffect","Link","axios","RMIUploader","Swiper","SwiperSlide","ReactLoading","Pagination","VisitDiary","props","applicationInfo","setapplicationInfo","selectedLecture","setSelectedLecture","visitingLogFileData","setVisitingLogFileData","visitingLogContent","setVisitingLogContent","visible","setVisible","page","setPage","postsPerPage","setpostsPerPage","settingInfo","setsettingInfo","visitingLogFile","readApplicationForms","readSettingInfo","response","get","process","env","REACT_APP_RESTAPI_HOST","params","token","window","sessionStorage","getItem","manageID","data","selectButton","visit_reg_date","feedback_id","hideModal","onUpload","onSelect","onRemove","id","insertVisitingLog","confirm","document","getElementsByClassName","click","FormData","headers","append","i","length","file","post","then","res","alert","deleteButton","console","log","url","method","application_form_id","handlePageChange","currentPosts","tmp","indexOfLast","indexOfFirst","slice","REACT_APP_DEFAULT_URL","color","find","element","key","value","split","map","item","history","location","pathname","index","church_name","date","lecture_name","visit_log","status","e","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { RMIUploader } from \"react-multiple-image-uploader\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ReactLoading from \"react-loading\";\nimport Pagination from \"react-js-pagination\";\n\nimport '../../../assets/css/table.css';\nimport '../../../assets/css/Contact.css';\n\n\nconst VisitDiary = (props) => {\n    const [applicationInfo, setapplicationInfo] = useState(null);\n    const [selectedLecture, setSelectedLecture] = useState(null);\n    const [visitingLogFileData, setVisitingLogFileData] = useState([]);\n    const [visitingLogContent, setVisitingLogContent] = useState(null)\n    const [visible, setVisible] = useState(false);\n    const [page, setPage] = useState(1);\n    // eslint-disable-next-line no-unused-vars\n    const [postsPerPage, setpostsPerPage] = useState(10);\n    const [settingInfo, setsettingInfo] = useState(null);\n\n    var visitingLogFile = [];\n\n    useEffect(() => {\n        readApplicationForms();\n        readSettingInfo();\n    },[]);\n\n    const readSettingInfo = async () => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'setting', {\n                params: {\n                    token: window.sessionStorage.getItem('token'),\n                    manageID: window.sessionStorage.getItem('id')\n                }\n            }\n        );\n        setsettingInfo(response.data)        \n    }\n\n    const selectButton = async(data) => {\n        if(selectedLecture === null || selectedLecture !== data) {\n            if(data.visit_reg_date !== null){\n                const response = await axios.get(\n                    process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/file/'+data.feedback_id, {\n                        params: {\n                            token: window.sessionStorage.getItem('token'),\n                            manageID: window.sessionStorage.getItem('id')\n                        }\n                    }\n                );\n                setVisitingLogFileData(response.data);\n            }\n            setSelectedLecture(data);\n        } else {\n            setSelectedLecture(null);\n        }\n    }\n\n    const readApplicationForms = async() => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'application/instructor/'+window.sessionStorage.getItem('id'), {\n                params: {\n                    token: window.sessionStorage.getItem('token'),\n                    manageID: window.sessionStorage.getItem('id')\n                }\n            }\n        );\n        setapplicationInfo(response.data);\n    }\n\n    const hideModal = () => {\n        setVisible(false);\n    };\n    const onUpload = (data) => {\n        visitingLogFile = data;\n    };\n    const onSelect = (data) => {\n    };\n    const onRemove = (id) => {\n    };\n\n    const insertVisitingLog = async() => {\n        if(window.confirm(\"방문일지를 저장하시겠습니까?\")) {\n            document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n            //document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n            //const blob = await fetch(base64).then(res => res.blob());\n\n            const params = new FormData();\n            const headers = {\n                'Content-type': 'multipart/form-data; charset=UTF-8',\n                'Accept': '*/*'\n            }\n            //var params = new URLSearchParams();\n            params.append('content', visitingLogContent);\n\n            for(var i=0; i<visitingLogFile.length; i++){\n                params.append('file', visitingLogFile[i].file);\n            }\n            params.append('token', window.sessionStorage.getItem('token'));\n            params.append('manageID', window.sessionStorage.getItem('id'));\n            \n            await axios.post(\n            process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/application_form/'+selectedLecture.id, //[loginID]로그인 후 변경\n            params,{headers}).then(function(res) {\n                alert(\"방문일지가 저장되었습니다.\")\n                readApplicationForms();\n                setSelectedLecture(null);\n            });\n        }\n    };\n    const deleteButton = async(data) => {\n        console.log(selectedLecture);\n        if(window.confirm(\"방문일지를 삭제하시겠습니까?\")) {\n            axios(\n                {\n                    url: process.env.REACT_APP_RESTAPI_HOST+'visiting_log',\n                    method: 'delete',\n                    data: {\n                        id: selectedLecture.feedback_id,\n                        application_form_id: selectedLecture.id,\n                        token: window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            ).then(function(res) {\n                alert(\"삭제가 완료되었습니다.\")\n                readApplicationForms();\n                setSelectedLecture(null);\n            })\n        }\n    }\n\n    const handlePageChange = (page) => { \n        setPage(page); \n    };\n\n    function currentPosts(tmp) {\n        var indexOfLast = page * postsPerPage;\n        var indexOfFirst = indexOfLast - postsPerPage;\n\n        let currentPosts = 0;\n        currentPosts = applicationInfo.slice(indexOfFirst, indexOfLast);\n        return currentPosts;\n    }\n\n    return (\n        <div>\n            <div className=\"mypage-image\">\n                <img className=\"page-background\" src={process.env.REACT_APP_DEFAULT_URL+'image/application.jpeg'} alt=\"lecture page\" />\n                <div className=\"page-info\">\n                    <h2>마이페이지</h2>\n                    <p style={{color:'black'}}>\n                        {settingInfo !== null ?\n                        settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map( (item, i) => <div key={i}>{item}</div>) :\n                        \"\"\n                        }\n                    </p>\n                </div>\n            </div>\n            <div className=\"inst-title-header\">\n                <h2 style={{color:'white'}}>마이페이지</h2>\n                <p>\n                    {settingInfo !== null ?\n                    settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map( (item, i) => <div key={i}>{item}</div>) :\n                    \"\"\n                    }\n                </p>\n            </div>\n            <div className=\"content-wrapper\">\n                <div className=\"left-navbar\">\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\"}>내 프로필</Link>\n                    </span>\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\"}>내 강의함</Link>\n                    </span>\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\"}>컨택 일정</Link>\n                    </span>\n                    <span>\n                    <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\"}>방문일지</Link>\n                    </span>\n                </div>\n                <div className=\"right-content\">\n                    <div className=\"table-wrapper\">\n                        <div className=\"table-row-visit\">\n                            <div className=\"th visit-index\"></div>\n                            <div className=\"th\">방문한 교회명</div>\n                            <div className=\"th visit-date\">다녀온 날짜</div>\n                            <div className=\"th\">일지 작성</div>\n                        </div>\n                        { applicationInfo !== null && applicationInfo.length >= 1?\n                            currentPosts(applicationInfo).map((data, index) => \n                                <div key={index} className={selectedLecture !== null && selectedLecture.id === data.id ? \"click-inst-row table-row-visit\" : \"table-row-visit\"} onClick = {() => {selectButton(data)}}>\n                                    <div className=\"td visit-index\">{(index+1)+((page-1)*postsPerPage)}</div>\n                                    <div className=\"td\">{data.church_name}</div>\n                                    <div className=\"td visit-date\">{data.date}</div>\n                                    {data.visit_reg_date !== null?\n                                        <span className=\"td\">피드백 완료</span>\n                                        :<span className=\"td\">피드백 미완료</span>\n                                    }\n                                </div>\n                            )\n                            :\n                            <div className=\"no-content\">신청서가 없습니다.</div>\n                        }\n                    </div>\n                    <Pagination \n                        activePage={page} \n                        itemsCountPerPage={postsPerPage} \n                        totalItemsCount={applicationInfo !== null ? applicationInfo.length : 0} \n                        pageRangeDisplayed={5} \n                        prevPageText={\"‹\"} \n                        nextPageText={\"›\"} \n                        onChange={handlePageChange} \n                    />\n                    {\n                        selectedLecture !== null && selectedLecture.visit_reg_date !== null?\n                            <div className=\"show-lecture-detail\">\n                                <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                                <p className=\"feedback-detail-content\">{selectedLecture.visit_log.split(\"\\n\").map( (item, i) => <div key={i}>{item}</div>)}</p>\n                                <div className=\"feedback-image-swiper-wrapper\">\n                                    <Swiper \n                                        spaceBetween={30} \n                                        effect={'fade'}\n                                        centeredSlides={true} \n                                        loop={true} loopFillGroupWithBlank={true}\n                                        pagination={{\n                                            \"clickable\": true\n                                        }} \n                                        navigation={true}\n                                        className=\"feedback-swiper\">\n                                            {visitingLogFileData !== null ?\n                                                visitingLogFileData.map((data, index) => (\n                                                    <SwiperSlide key = {index}>\n                                                        <div className=\"feedback-image-wrapper\"><img src={process.env.REACT_APP_RESTAPI_HOST+\"resources/upload/\"+data} alt=\"uploadFile\"/></div>\n                                                    </SwiperSlide>\n                                                ))\n                                                : <ReactLoading type=\"spin\" color=\"#05589c\" />\n                                            }\n                                    </Swiper>\n                                </div>\n                                <button className=\"feedback-submit\" onClick={deleteButton}>삭제하기</button>\n                            </div>\n                        :selectedLecture !== null && selectedLecture.status === 2?\n                            <div className=\"show-lecture-detail\">\n                                <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                                <textarea className=\"feedback-textarea\" placeholder=\"글 남기기\" onChange={(e) => {setVisitingLogContent(e.target.value); }}></textarea>\n                                <RMIUploader\n                                    isOpen={visible}\n                                    hideModal={hideModal}\n                                    onSelect={onSelect}\n                                    onUpload={onUpload}\n                                    onRemove={onRemove}\n                                    dataSources={[]}\n                                />\n                                <button className=\"feedback-submit\" onClick={() => insertVisitingLog()}>작성 완료하기</button>\n                            </div>\n                        :null\n                    }\n                </div>\n\n            </div>\n        </div>\n    )\n}\n\nexport default VisitDiary;"]},"metadata":{},"sourceType":"module"}