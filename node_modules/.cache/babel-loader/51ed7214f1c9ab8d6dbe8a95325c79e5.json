{"ast":null,"code":"import _regeneratorRuntime from\"/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from'axios';import XLSX from\"xlsx\";import FileSaver from\"file-saver\";import{Swiper,SwiperSlide}from\"swiper/react\";import ReactLoading from\"react-loading\";import{RMIUploader}from\"react-multiple-image-uploader\";import Pagination from\"react-js-pagination\";import'../../../assets/css/table.css';import'../../../assets/css/default.css';import'../../../assets/css/admin_feedback.css';import GreyButton from'../../modules/button/admin_grey_btn';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AdminVisitDiary(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selectedLecture=_useState2[0],setSelectedLecture=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),applicationInfo=_useState4[0],setapplicationInfo=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),feedbackFileData=_useState6[0],setFeedbackFileData=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),keyword=_useState8[0],setKeyword=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),addButton=_useState10[0],setAddButton=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),visitingLogContent=_useState12[0],setVisitingLogContent=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),visible=_useState14[0],setVisible=_useState14[1];var visitingLogFile=[];var _useState15=useState(1),_useState16=_slicedToArray(_useState15,2),page=_useState16[0],setPage=_useState16[1];var postsPerPage=10;useEffect(function(){readApplicationForms();// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var readApplicationForms=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,_response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(keyword!==null)){_context.next=7;break;}_context.next=3;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'application/visiting_log',{params:{keyword:encodeURI(keyword),token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 3:response=_context.sent;setapplicationInfo(response.data);_context.next=11;break;case 7:_context.next=9;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'application/visiting_log',{params:{token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 9:_response=_context.sent;setapplicationInfo(_response.data);case 11:setKeyword(null);setSelectedLecture(null);case 13:case\"end\":return _context.stop();}}},_callee);}));return function readApplicationForms(){return _ref.apply(this,arguments);};}();var selectButton=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(selectedLecture===null||selectedLecture!==data)){_context2.next=9;break;}if(!(data.visit_reg_date!==null)){_context2.next=6;break;}_context2.next=4;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'visiting_log/file/'+data.feedback_id,{params:{token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}});case 4:response=_context2.sent;setFeedbackFileData(response.data);case 6:setSelectedLecture(data);_context2.next=10;break;case 9:setSelectedLecture(null);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function selectButton(_x){return _ref2.apply(this,arguments);};}();var deleteButton=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data){var value;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:value=window.confirm(\"강사가 작성한 내용입니다. 삭제할까요?\");if(value!==false){axios({url:process.env.REACT_APP_RESTAPI_HOST+'visiting_log',method:'delete',data:{id:selectedLecture.feedback_id,token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}}).then(function(res){alert(\"삭제가 완료되었습니다.\");readApplicationForms();setSelectedLecture(null);});}case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteButton(_x2){return _ref3.apply(this,arguments);};}();var searchKeywordChanged=function searchKeywordChanged(e){setKeyword(e.target.value);};var hideModal=function hideModal(){setVisible(false);};var onUpload=function onUpload(data){visitingLogFile=data;};var insertVisitingLog=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var params,headers,i;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();//document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n//const blob = await fetch(base64).then(res => res.blob());\nparams=new FormData();headers={'Content-type':'multipart/form-data; charset=UTF-8','Accept':'*/*'};//var params = new URLSearchParams();\nparams.append('content',visitingLogContent);params.append('token',window.sessionStorage.getItem('token'));params.append('manageID',window.sessionStorage.getItem('id'));for(i=0;i<visitingLogFile.length;i++){params.append('file',visitingLogFile[i].file);}_context4.next=9;return axios.post(process.env.REACT_APP_RESTAPI_HOST+'visiting_log/application_form/'+selectedLecture.id,//[loginID]로그인 후 변경\nparams,{headers:headers});case 9:readApplicationForms();setSelectedLecture(null);case 11:case\"end\":return _context4.stop();}}},_callee4);}));return function insertVisitingLog(){return _ref4.apply(this,arguments);};}();var handlePageChange=function handlePageChange(page){setPage(page);};function currentPosts(tmp){var indexOfLast=page*postsPerPage;var indexOfFirst=indexOfLast-postsPerPage;var currentPosts=0;currentPosts=applicationInfo.slice(indexOfFirst,indexOfLast);return currentPosts;}var exportToCSV=function exportToCSV(){var fileType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";var fileExtension=\".xlsx\";var fileName=\"visitDiary\";var ws=XLSX.utils.json_to_sheet(applicationInfo);var wb={Sheets:{data:ws},SheetNames:[\"data\"]};var excelBuffer=XLSX.write(wb,{bookType:\"xlsx\",type:\"array\"});var data=new Blob([excelBuffer],{type:fileType});FileSaver.saveAs(data,fileName+fileExtension);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"admin-title-header\",children:\"\\uAE30\\uD0C0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"admin-content-wrapper\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"table-name mb40\",children:[\"\\uBC29\\uBB38\\uC77C\\uC9C0 \\uAD00\\uB9AC\",/*#__PURE__*/_jsx(GreyButton,{class:\"right\",name:\"\\uC5D1\\uC140 \\uD30C\\uC77C \\uB2E4\\uC6B4\\uB85C\\uB4DC\",click:exportToCSV})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"feedback-flex-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{id:\"feedback-table\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"feedback-search\",children:[/*#__PURE__*/_jsx(\"input\",{className:\"p48\",type:\"text\",placeholder:\"\\uAD00\\uB9AC\\uC790\\uBA85, \\uAC15\\uC0AC\\uBA85, \\uAC15\\uC758\\uBA85, \\uAD50\\uD68C\\uBA85, \\uC8FC\\uC18C, \\uC0AC\\uC6A9\\uC790 \\uC774\\uBA54\\uC77C\\uB85C \\uD0A4\\uC6CC\\uB4DC \\uAC80\\uC0C9\",value:keyword||\"\",onChange:searchKeywordChanged}),/*#__PURE__*/_jsx(GreyButton,{name:\"\\uAC80\\uC0C9\",click:readApplicationForms})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mt50 table-row-feedback\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"th feedback-category\",children:\"NO\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th\",children:\"\\uAC15\\uC758\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th feedback-date\",children:\"\\uAC15\\uC5F0\\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th\",children:\"\\uAC15\\uC0AC\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{className:\"th feedback-yn\",children:\"\\uC791\\uC131\\uC5EC\\uBD80\"})]}),applicationInfo!==null?currentPosts(applicationInfo).map(function(data,index){return/*#__PURE__*/_jsxs(\"div\",{className:selectedLecture!==null&&selectedLecture.id===data.id?\"click-inst-row table-row-feedback\":\"table-row-feedback\",onClick:function onClick(){selectButton(data);},children:[/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:index+1+(page-1)*postsPerPage}),/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:data.lecture_name}),/*#__PURE__*/_jsx(\"span\",{className:\"td feedback-date\",children:data.date}),/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:data.inst_name}),data.visit_reg_date!==null?/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:\"\\uC644\\uB8CC\"}):/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:\"\\uBBF8\\uC644\\uB8CC\"})]},index);}):/*#__PURE__*/_jsx(\"div\",{id:\"no-feedback-detail\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uBC29\\uBB38\\uC77C\\uC9C0\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})})]})}),/*#__PURE__*/_jsx(Pagination,{activePage:page,itemsCountPerPage:postsPerPage,totalItemsCount:applicationInfo!==null?applicationInfo.length:0,pageRangeDisplayed:5,prevPageText:\"‹\",nextPageText:\"›\",onChange:handlePageChange})]}),selectedLecture!==null&&selectedLecture.visit_reg_date!==null?/*#__PURE__*/_jsxs(\"div\",{className:\"show-lecture-detail\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"regular\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bold\",children:selectedLecture.lecture_name}),\"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"feedback-detail-content\",children:selectedLecture.visit_log.split(\"\\n\").map(function(item,i){return/*#__PURE__*/_jsx(\"div\",{children:item},i);})}),/*#__PURE__*/_jsx(\"div\",{className:\"feedback-image-swiper-wrapper\",children:/*#__PURE__*/_jsx(Swiper,{spaceBetween:30,effect:'fade',centeredSlides:true,loop:true,loopFillGroupWithBlank:true,pagination:{\"clickable\":true},navigation:true,className:\"feedback-swiper\",children:feedbackFileData!==null?feedbackFileData.map(function(data,index){return/*#__PURE__*/_jsx(SwiperSlide,{children:/*#__PURE__*/_jsx(\"div\",{className:\"feedback-image-wrapper\",children:/*#__PURE__*/_jsx(\"img\",{src:process.env.REACT_APP_RESTAPI_HOST+\"resources/upload/\"+data,alt:\"uploadFile\"})})},index);}):/*#__PURE__*/_jsx(ReactLoading,{type:\"spin\",color:\"#05589c\"})})}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-submit\",onClick:deleteButton,children:\"\\uC0AD\\uC81C\\uD558\\uAE30\"})]}):selectedLecture!==null&&addButton===true?/*#__PURE__*/_jsxs(\"div\",{className:\"show-lecture-detail\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"regular\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bold\",children:selectedLecture.lecture_name}),\"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"feedback-textarea\",placeholder:\"\\uAE00 \\uB0A8\\uAE30\\uAE30\",onChange:function onChange(e){setVisitingLogContent(e.target.value);}}),/*#__PURE__*/_jsx(RMIUploader,{isOpen:visible,hideModal:hideModal// onSelect={onSelect}\n,onUpload:onUpload// onRemove={onRemove}\n,dataSources:[]}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-submit\",onClick:function onClick(){return insertVisitingLog();},children:\"\\uC791\\uC131 \\uC644\\uB8CC\\uD558\\uAE30\"})]}):selectedLecture!==null?/*#__PURE__*/_jsxs(\"div\",{className:\"show-lecture-detail\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"mb20\",children:selectedLecture.lecture_name}),/*#__PURE__*/_jsx(\"hr\",{className:\"bold-hr mb25\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC2E0\\uCCAD\\uC790\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.admin_name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC5F0\\uB77D\\uCC98\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.admin_phone})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m20\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uAD50\\uD68C\\uBA85\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.church_name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC8FC\\uC18C\"}),/*#__PURE__*/_jsxs(\"span\",{children:[selectedLecture.addr1,\" \",selectedLecture.addr2]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uAD50\\uD68C \\uC5F0\\uB77D\\uCC98\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.phone})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uAD50\\uD68C \\uC774\\uBA54\\uC77C\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.email})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m20\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uAC15\\uC758 \\uB300\\uC0C1\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.attendee_target})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uCCAD\\uAC15\\uC790 \\uC218\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.attendee_number})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb8\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC6D0\\uD558\\uB294 \\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.date})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb35\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC6D0\\uD558\\uB294 \\uC2DC\\uAC04\\uB300\"}),selectedLecture.status===2?/*#__PURE__*/_jsxs(\"span\",{children:[selectedLecture.contact_start_date,\" ~ \",selectedLecture.contact_end_date]}):/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.timezone})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb25 form-grid\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"form-title\",children:\"\\uC694\\uCCAD\\uC0AC\\uD56D\"}),/*#__PURE__*/_jsx(\"span\",{children:selectedLecture.memo.split(\"<br/>\").map(function(item,i){return/*#__PURE__*/_jsx(\"div\",{children:item},i);})})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"bold-hr mb35\"}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-submit\",onClick:function onClick(){setAddButton(true);},children:\"\\uBC29\\uBB38\\uC77C\\uC9C0 \\uB4F1\\uB85D\\uD558\\uAE30\"})]}):/*#__PURE__*/_jsx(\"div\",{id:\"no-feedback-detail\",children:/*#__PURE__*/_jsx(\"span\",{children:\"\\uBC29\\uBB38\\uC77C\\uC9C0\\uB97C \\uC120\\uD0DD\\uD574\\uC8FC\\uC138\\uC694.\"})})]})]})]});}export default AdminVisitDiary;","map":{"version":3,"sources":["/Users/hyerm2/Desktop/project/vision/CourseApplicationManagement_frontend/course_application_management/src/components/pages/admin/visitDiary.js"],"names":["React","useState","useEffect","axios","XLSX","FileSaver","Swiper","SwiperSlide","ReactLoading","RMIUploader","Pagination","GreyButton","AdminVisitDiary","selectedLecture","setSelectedLecture","applicationInfo","setapplicationInfo","feedbackFileData","setFeedbackFileData","keyword","setKeyword","addButton","setAddButton","visitingLogContent","setVisitingLogContent","visible","setVisible","visitingLogFile","page","setPage","postsPerPage","readApplicationForms","get","process","env","REACT_APP_RESTAPI_HOST","params","encodeURI","token","window","sessionStorage","getItem","manageID","response","data","selectButton","visit_reg_date","feedback_id","deleteButton","value","confirm","url","method","id","then","res","alert","searchKeywordChanged","e","target","hideModal","onUpload","insertVisitingLog","document","getElementsByClassName","click","FormData","headers","append","i","length","file","post","handlePageChange","currentPosts","tmp","indexOfLast","indexOfFirst","slice","exportToCSV","fileType","fileExtension","fileName","ws","utils","json_to_sheet","wb","Sheets","SheetNames","excelBuffer","write","bookType","type","Blob","saveAs","map","index","lecture_name","date","inst_name","visit_log","split","item","admin_name","admin_phone","church_name","addr1","addr2","phone","email","attendee_target","attendee_number","status","contact_start_date","contact_end_date","timezone","memo"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport axios from 'axios';\nimport XLSX from \"xlsx\";\nimport FileSaver from \"file-saver\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ReactLoading from \"react-loading\";\nimport { RMIUploader } from \"react-multiple-image-uploader\";\nimport Pagination from \"react-js-pagination\";\nimport '../../../assets/css/table.css';\nimport '../../../assets/css/default.css';\nimport '../../../assets/css/admin_feedback.css';\nimport GreyButton from '../../modules/button/admin_grey_btn';\n\nfunction AdminVisitDiary() {\n    const [selectedLecture, setSelectedLecture] = useState(null);\n    const [applicationInfo, setapplicationInfo] = useState(null);\n    const [feedbackFileData, setFeedbackFileData] = useState(null);\n    const [keyword, setKeyword] = useState(null);\n    const [addButton, setAddButton] = useState(false);\n    const [visitingLogContent, setVisitingLogContent] = useState(null)\n    const [visible, setVisible] = useState(false);\n    var visitingLogFile = [];\n    const [page, setPage] = useState(1);\n    const postsPerPage = 10;\n\n    useEffect(() => {\n        readApplicationForms();\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    },[]);\n\n    const readApplicationForms = async() => {\n        if(keyword !== null){\n            const response = await axios.get(\n                process.env.REACT_APP_RESTAPI_HOST + 'application/visiting_log',\n                {\n                    params: {\n                        keyword: encodeURI(keyword),\n                        token:  window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            );\n            setapplicationInfo(response.data);\n        }else {\n            const response = await axios.get(\n                process.env.REACT_APP_RESTAPI_HOST + 'application/visiting_log', {\n                    params: {\n                        token: window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            );\n            setapplicationInfo(response.data);\n        }\n        setKeyword(null);\n        setSelectedLecture(null);\n    }\n\n    const selectButton = async(data) => {\n        if(selectedLecture === null || selectedLecture !== data) {\n            if(data.visit_reg_date !== null){\n                const response = await axios.get(\n                    process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/file/'+data.feedback_id, {\n                        params: {\n                            token: window.sessionStorage.getItem('token'),\n                            manageID: window.sessionStorage.getItem('id')\n                        }\n                    }\n                );\n                setFeedbackFileData(response.data);\n            }\n            setSelectedLecture(data);\n        } else {\n            setSelectedLecture(null);\n        }\n        \n    }\n\n    const deleteButton = async(data) => {\n        var value = window.confirm(\"강사가 작성한 내용입니다. 삭제할까요?\");\n        if(value !== false){\n            axios(\n                {\n                    url: process.env.REACT_APP_RESTAPI_HOST+'visiting_log',\n                    method: 'delete',\n                    data: {\n                        id: selectedLecture.feedback_id,\n                        token:  window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            ).then(function(res) {\n                alert(\"삭제가 완료되었습니다.\")\n                readApplicationForms();\n                setSelectedLecture(null);\n            })\n        }\n    }\n    const searchKeywordChanged = e => {\n        setKeyword(e.target.value);\n    }\n\n    const hideModal = () => {\n        setVisible(false);\n    };\n    const onUpload = (data) => {\n        visitingLogFile = data;\n    };\n    const insertVisitingLog = async() => {\n        document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n        //document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n        //const blob = await fetch(base64).then(res => res.blob());\n\n        const params = new FormData();\n        const headers = {\n            'Content-type': 'multipart/form-data; charset=UTF-8',\n            'Accept': '*/*'\n          }\n        //var params = new URLSearchParams();\n        params.append('content', visitingLogContent);\n        params.append('token', window.sessionStorage.getItem('token'));\n        params.append('manageID', window.sessionStorage.getItem('id'));\n\n        for(var i=0; i<visitingLogFile.length; i++){\n            params.append('file', visitingLogFile[i].file);\n        }\n        await axios.post(\n        process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/application_form/'+selectedLecture.id, //[loginID]로그인 후 변경\n        params,{headers});\n        readApplicationForms();\n        setSelectedLecture(null);\n\n    };\n\n    const handlePageChange = (page) => { \n        setPage(page); \n    };\n\n    function currentPosts(tmp) {\n        var indexOfLast = page * postsPerPage;\n        var indexOfFirst = indexOfLast - postsPerPage;\n\n        let currentPosts = 0;\n        currentPosts = applicationInfo.slice(indexOfFirst, indexOfLast);\n        return currentPosts;\n    }\n\n    const exportToCSV = () => {\n        const fileType = \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\n        const fileExtension = \".xlsx\";\n        const fileName = \"visitDiary\";\n        const ws = XLSX.utils.json_to_sheet(applicationInfo);\n        const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\n        const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\n        const data = new Blob([excelBuffer], { type: fileType });\n        FileSaver.saveAs(data, fileName + fileExtension);\n    };\n\n\n    return (\n        <div>\n            <p className=\"admin-title-header\">기타</p>\n            <div className=\"admin-content-wrapper\">\n                <p className=\"table-name mb40\">\n                    방문일지 관리\n                    <GreyButton class=\"right\" name=\"엑셀 파일 다운로드\" click={exportToCSV}/>\n                </p>\n                <div id=\"feedback-flex-wrapper\">\n                    <div id=\"feedback-table\">\n                        <div className=\"feedback-search\">\n                            <input className=\"p48\" type=\"text\" placeholder=\"관리자명, 강사명, 강의명, 교회명, 주소, 사용자 이메일로 키워드 검색\" value={keyword || \"\"} onChange={searchKeywordChanged}/>\n                            <GreyButton name=\"검색\" click={readApplicationForms}/>\n                        </div>\n                        <div className=\"table-wrapper\">\n                            <div>\n                                <div className=\"mt50 table-row-feedback\">\n                                    <span className=\"th feedback-category\">NO</span>\n                                    <span className=\"th\">강의명</span>\n                                    <span className=\"th feedback-date\">강연날짜</span>\n                                    <span className=\"th\">강사명</span>\n                                    <span className=\"th feedback-yn\">작성여부</span>\n                                </div>\n                            { applicationInfo !== null ?\n                                currentPosts(applicationInfo).map((data, index) => \n                                    <div key={index} className={selectedLecture !== null && selectedLecture.id === data.id ? \"click-inst-row table-row-feedback\" : \"table-row-feedback\"} onClick = {() => {selectButton(data)}}>\n                                        <span className=\"td\">{(index+1)+((page-1)*postsPerPage)}</span>\n                                        <span className=\"td\">{data.lecture_name}</span>\n                                        <span className=\"td feedback-date\">{data.date}</span>\n                                        <span className=\"td\">{data.inst_name}</span>\n                                        {data.visit_reg_date !== null?\n                                            <span className=\"td\">완료</span>\n                                            : <span className=\"td\">미완료</span>\n                                        }\n                                    </div>\n                                )\n                                :\n                                <div id=\"no-feedback-detail\"><span>방문일지가 없습니다.</span></div>\n                            }\n                        </div>\n                    </div>\n                    <Pagination \n                        activePage={page} \n                        itemsCountPerPage={postsPerPage} \n                        totalItemsCount={applicationInfo !== null ? applicationInfo.length : 0} \n                        pageRangeDisplayed={5} \n                        prevPageText={\"‹\"} \n                        nextPageText={\"›\"} \n                        onChange={handlePageChange} \n                    />  \n\n                    </div>\n                    {    selectedLecture !== null && selectedLecture.visit_reg_date !== null?\n                        <div className=\"show-lecture-detail\">\n                        <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                        <p className=\"feedback-detail-content\">{selectedLecture.visit_log.split(\"\\n\").map( (item, i) => <div key={i}>{item}</div>)}</p>\n                        <div className=\"feedback-image-swiper-wrapper\">\n                        <Swiper \n                            spaceBetween={30} \n                            effect={'fade'}\n                            centeredSlides={true} \n                            loop={true} loopFillGroupWithBlank={true}\n                            pagination={{\n                                \"clickable\": true\n                            }} \n                            navigation={true}\n                            className=\"feedback-swiper\">\n                                {feedbackFileData !== null ?\n                            feedbackFileData.map((data, index) => (\n                                <SwiperSlide key = {index}>\n                                    <div className=\"feedback-image-wrapper\"><img src={process.env.REACT_APP_RESTAPI_HOST+\"resources/upload/\"+data} alt=\"uploadFile\"/></div>\n                                </SwiperSlide>\n                            ))\n                            : <ReactLoading type=\"spin\" color=\"#05589c\" />\n                        }\n                            </Swiper></div>\n                        <button className=\"feedback-submit\" onClick={deleteButton}>삭제하기</button>\n                    </div>: selectedLecture !== null && addButton === true?\n                        <div className=\"show-lecture-detail\">\n                            <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                            <textarea className=\"feedback-textarea\" placeholder=\"글 남기기\" onChange={(e) => {setVisitingLogContent(e.target.value); }}></textarea>\n                            <RMIUploader\n                                isOpen={visible}\n                                hideModal={hideModal}\n                                // onSelect={onSelect}\n                                onUpload={onUpload}\n                                // onRemove={onRemove}\n                                dataSources={[]}\n                            />\n                            <button className=\"feedback-submit\" onClick={() => insertVisitingLog()}>작성 완료하기</button>\n                        </div>\n                    :selectedLecture !== null ?\n                     <div className=\"show-lecture-detail\">\n                        <h2 className=\"mb20\">{selectedLecture.lecture_name}</h2>\n                        <hr className=\"bold-hr mb25\"/>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">신청자명</span>\n                            <span>{selectedLecture.admin_name}</span>\n                        </div>\n                        <div>\n                            <span className=\"form-title\">연락처</span>\n                            <span>{selectedLecture.admin_phone}</span>\n                        </div>\n                        <hr className=\"m20\"/>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">교회명</span>\n                            <span>{selectedLecture.church_name}</span>\n                        </div>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">주소</span>\n                            <span>{selectedLecture.addr1} {selectedLecture.addr2}</span>\n                        </div>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">교회 연락처</span>\n                            <span>{selectedLecture.phone}</span>\n                        </div>\n                        <div>\n                            <span className=\"form-title\">교회 이메일</span>\n                            <span>{selectedLecture.email}</span>\n                        </div>\n                        <hr className=\"m20\"/>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">강의 대상</span>\n                            <span>{selectedLecture.attendee_target}</span>\n                        </div>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">청강자 수</span>\n                            <span>{selectedLecture.attendee_number}</span>\n                        </div>\n                        <div className=\"mb8\">\n                            <span className=\"form-title\">원하는 날짜</span>\n                            <span>{selectedLecture.date}</span>\n                        </div>\n                        <div className=\"mb35\">\n                            <span className=\"form-title\">원하는 시간대</span>\n                            {selectedLecture.status === 2 ?\n                            <span>{selectedLecture.contact_start_date} ~ {selectedLecture.contact_end_date}</span>:\n                            <span>{selectedLecture.timezone}</span>}\n                        </div>\n                        <div className=\"mb25 form-grid\">\n                            <span className=\"form-title\">요청사항</span>\n                            <span>{selectedLecture.memo.split(\"<br/>\").map( (item, i) => <div key={i}>{item}</div>)}</span>\n                        </div>\n                        <hr className=\"bold-hr mb35\"/>\n                        <button className=\"feedback-submit\" onClick={() => {setAddButton(true)}}>방문일지 등록하기</button>\n                    </div>:<div id=\"no-feedback-detail\"><span>방문일지를 선택해주세요.</span></div>\n                    }\n                </div>\n            </div>\n        </div>\n    )\n\n}\n\nexport default AdminVisitDiary;"]},"metadata":{},"sourceType":"module"}