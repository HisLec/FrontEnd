{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import axios from'axios';import{RMIUploader}from\"react-multiple-image-uploader\";import{Swiper,SwiperSlide}from\"swiper/react\";import ReactLoading from\"react-loading\";import Pagination from\"react-js-pagination\";import'../../../assets/css/table.css';import'../../../assets/css/Contact.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var VisitDiary=function VisitDiary(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),applicationInfo=_useState2[0],setapplicationInfo=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selectedLecture=_useState4[0],setSelectedLecture=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),visitingLogFileData=_useState6[0],setVisitingLogFileData=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),visitingLogContent=_useState8[0],setVisitingLogContent=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),visible=_useState10[0],setVisible=_useState10[1];var _useState11=useState(1),_useState12=_slicedToArray(_useState11,2),page=_useState12[0],setPage=_useState12[1];// eslint-disable-next-line no-unused-vars\nvar _useState13=useState(10),_useState14=_slicedToArray(_useState13,2),postsPerPage=_useState14[0],setpostsPerPage=_useState14[1];var _useState15=useState(null),_useState16=_slicedToArray(_useState15,2),settingInfo=_useState16[0],setsettingInfo=_useState16[1];var visitingLogFile=[];useEffect(function(){readApplicationForms();readSettingInfo();},[]);var readSettingInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'setting',{params:{token:window.sessionStorage.getItem('token')}});case 2:response=_context.sent;setsettingInfo(response.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function readSettingInfo(){return _ref.apply(this,arguments);};}();var selectButton=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(selectedLecture===null||selectedLecture!==data)){_context2.next=9;break;}if(!(data.visit_reg_date!==null)){_context2.next=6;break;}_context2.next=4;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'visiting_log/file/'+data.feedback_id,{params:{token:window.sessionStorage.getItem('token')}});case 4:response=_context2.sent;setVisitingLogFileData(response.data);case 6:setSelectedLecture(data);_context2.next=10;break;case 9:setSelectedLecture(null);case 10:case\"end\":return _context2.stop();}}},_callee2);}));return function selectButton(_x){return _ref2.apply(this,arguments);};}();var readApplicationForms=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.get(process.env.REACT_APP_RESTAPI_HOST+'application/instructor/'+window.sessionStorage.getItem('id'),{params:{token:window.sessionStorage.getItem('token')}});case 2:response=_context3.sent;setapplicationInfo(response.data);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function readApplicationForms(){return _ref3.apply(this,arguments);};}();var hideModal=function hideModal(){setVisible(false);};var onUpload=function onUpload(data){visitingLogFile=data;};var onSelect=function onSelect(data){};var onRemove=function onRemove(id){};var insertVisitingLog=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var params,headers,i;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!window.confirm(\"방문일지를 저장하시겠습니까?\")){_context4.next=10;break;}document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();//document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n//const blob = await fetch(base64).then(res => res.blob());\nparams=new FormData();headers={'Content-type':'multipart/form-data; charset=UTF-8','Accept':'*/*'};//var params = new URLSearchParams();\nparams.append('content',visitingLogContent);for(i=0;i<visitingLogFile.length;i++){params.append('file',visitingLogFile[i].file);}params.append('token',window.sessionStorage.getItem('token'));params.append('manageID',window.sessionStorage.getItem('id'));_context4.next=10;return axios.post(process.env.REACT_APP_RESTAPI_HOST+'visiting_log/application_form/'+selectedLecture.id,//[loginID]로그인 후 변경\nparams,{headers:headers}).then(function(res){alert(\"방문일지가 저장되었습니다.\");readApplicationForms();setSelectedLecture(null);});case 10:case\"end\":return _context4.stop();}}},_callee4);}));return function insertVisitingLog(){return _ref4.apply(this,arguments);};}();var deleteButton=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(window.confirm(\"방문일지를 삭제하시겠습니까?\")){axios({url:process.env.REACT_APP_RESTAPI_HOST+'visiting_log',method:'delete',data:{id:selectedLecture.feedback_id,token:window.sessionStorage.getItem('token'),manageID:window.sessionStorage.getItem('id')}}).then(function(res){alert(\"삭제가 완료되었습니다.\");readApplicationForms();setSelectedLecture(null);});}case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function deleteButton(_x2){return _ref5.apply(this,arguments);};}();var handlePageChange=function handlePageChange(page){setPage(page);};function currentPosts(tmp){var indexOfLast=page*postsPerPage;var indexOfFirst=indexOfLast-postsPerPage;var currentPosts=0;currentPosts=applicationInfo.slice(indexOfFirst,indexOfLast);return currentPosts;}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mypage-image\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"page-background\",src:process.env.REACT_APP_DEFAULT_URL+'image/application.jpeg',alt:\"lecture page\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"page-info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"}),/*#__PURE__*/_jsx(\"p\",{style:{color:'black'},children:settingInfo!==null?settingInfo.find(function(element){return element.key===\"mypage_visit_phrase\";}).value.split(\"<br/>\").map(function(item,i){return/*#__PURE__*/_jsx(\"div\",{children:item},i);}):\"\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"inst-title-header\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{color:'white'},children:\"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"}),/*#__PURE__*/_jsx(\"p\",{children:settingInfo!==null?settingInfo.find(function(element){return element.key===\"mypage_visit_phrase\";}).value.split(\"<br/>\").map(function(item,i){return/*#__PURE__*/_jsx(\"div\",{children:item},i);}):\"\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-navbar\",children:[/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Link,{className:props.history.location.pathname===process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\"?\"left-active\":\"\",to:process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\",children:\"\\uB0B4 \\uD504\\uB85C\\uD544\"})}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Link,{className:props.history.location.pathname===process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\"?\"left-active\":\"\",to:process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\",children:\"\\uB0B4 \\uAC15\\uC758\\uD568\"})}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Link,{className:props.history.location.pathname===process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\"?\"left-active\":\"\",to:process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\",children:\"\\uCEE8\\uD0DD \\uC77C\\uC815\"})}),/*#__PURE__*/_jsx(\"span\",{children:/*#__PURE__*/_jsx(Link,{className:props.history.location.pathname===process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\"?\"left-active\":\"\",to:process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\",children:\"\\uBC29\\uBB38\\uC77C\\uC9C0\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"right-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-wrapper\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"table-row-visit\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"th visit-index\"}),/*#__PURE__*/_jsx(\"div\",{className:\"th\",children:\"\\uBC29\\uBB38\\uD55C \\uAD50\\uD68C\\uBA85\"}),/*#__PURE__*/_jsx(\"div\",{className:\"th visit-date\",children:\"\\uB2E4\\uB140\\uC628 \\uB0A0\\uC9DC\"}),/*#__PURE__*/_jsx(\"div\",{className:\"th\",children:\"\\uC77C\\uC9C0 \\uC791\\uC131\"})]}),applicationInfo!==null&&applicationInfo.length>=1?currentPosts(applicationInfo).map(function(data,index){return/*#__PURE__*/_jsxs(\"div\",{className:selectedLecture!==null&&selectedLecture.id===data.id?\"click-inst-row table-row-visit\":\"table-row-visit\",onClick:function onClick(){selectButton(data);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"td visit-index\",children:index+1+(page-1)*postsPerPage}),/*#__PURE__*/_jsx(\"div\",{className:\"td\",children:data.church_name}),/*#__PURE__*/_jsx(\"div\",{className:\"td visit-date\",children:data.date}),data.visit_reg_date!==null?/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:\"\\uD53C\\uB4DC\\uBC31 \\uC644\\uB8CC\"}):/*#__PURE__*/_jsx(\"span\",{className:\"td\",children:\"\\uD53C\\uB4DC\\uBC31 \\uBBF8\\uC644\\uB8CC\"})]},index);}):/*#__PURE__*/_jsx(\"div\",{className:\"no-content\",children:\"\\uC2E0\\uCCAD\\uC11C\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]}),/*#__PURE__*/_jsx(Pagination,{activePage:page,itemsCountPerPage:postsPerPage,totalItemsCount:applicationInfo!==null?applicationInfo.length:0,pageRangeDisplayed:5,prevPageText:\"‹\",nextPageText:\"›\",onChange:handlePageChange}),selectedLecture!==null&&selectedLecture.visit_reg_date!==null?/*#__PURE__*/_jsxs(\"div\",{className:\"show-lecture-detail\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"regular\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bold\",children:selectedLecture.lecture_name}),\"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsx(\"p\",{className:\"feedback-detail-content\",children:selectedLecture.visit_log.split(\"\\n\").map(function(item,i){return/*#__PURE__*/_jsx(\"div\",{children:item},i);})}),/*#__PURE__*/_jsx(\"div\",{className:\"feedback-image-swiper-wrapper\",children:/*#__PURE__*/_jsx(Swiper,{spaceBetween:30,effect:'fade',centeredSlides:true,loop:true,loopFillGroupWithBlank:true,pagination:{\"clickable\":true},navigation:true,className:\"feedback-swiper\",children:visitingLogFileData!==null?visitingLogFileData.map(function(data,index){return/*#__PURE__*/_jsx(SwiperSlide,{children:/*#__PURE__*/_jsx(\"div\",{className:\"feedback-image-wrapper\",children:/*#__PURE__*/_jsx(\"img\",{src:process.env.REACT_APP_RESTAPI_HOST+\"resources/upload/\"+data,alt:\"uploadFile\"})})},index);}):/*#__PURE__*/_jsx(ReactLoading,{type:\"spin\",color:\"#05589c\"})})}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-submit\",onClick:deleteButton,children:\"\\uC0AD\\uC81C\\uD558\\uAE30\"})]}):selectedLecture!==null&&selectedLecture.status===2?/*#__PURE__*/_jsxs(\"div\",{className:\"show-lecture-detail\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"regular\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"bold\",children:selectedLecture.lecture_name}),\"\\uB97C \\uAC15\\uC5F0\\uD558\\uC168\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"feedback-textarea\",placeholder:\"\\uAE00 \\uB0A8\\uAE30\\uAE30\",onChange:function onChange(e){setVisitingLogContent(e.target.value);}}),/*#__PURE__*/_jsx(RMIUploader,{isOpen:visible,hideModal:hideModal,onSelect:onSelect,onUpload:onUpload,onRemove:onRemove,dataSources:[]}),/*#__PURE__*/_jsx(\"button\",{className:\"feedback-submit\",onClick:function onClick(){return insertVisitingLog();},children:\"\\uC791\\uC131 \\uC644\\uB8CC\\uD558\\uAE30\"})]}):null]})]})]});};export default VisitDiary;","map":{"version":3,"sources":["/Users/jeong-yeeun/git/CourseApplicationManagement_frontend/course_application_management/src/components/pages/mypage/visitDiary.js"],"names":["React","useState","useEffect","Link","axios","RMIUploader","Swiper","SwiperSlide","ReactLoading","Pagination","VisitDiary","props","applicationInfo","setapplicationInfo","selectedLecture","setSelectedLecture","visitingLogFileData","setVisitingLogFileData","visitingLogContent","setVisitingLogContent","visible","setVisible","page","setPage","postsPerPage","setpostsPerPage","settingInfo","setsettingInfo","visitingLogFile","readApplicationForms","readSettingInfo","get","process","env","REACT_APP_RESTAPI_HOST","params","token","window","sessionStorage","getItem","response","data","selectButton","visit_reg_date","feedback_id","hideModal","onUpload","onSelect","onRemove","id","insertVisitingLog","confirm","document","getElementsByClassName","click","FormData","headers","append","i","length","file","post","then","res","alert","deleteButton","url","method","manageID","handlePageChange","currentPosts","tmp","indexOfLast","indexOfFirst","slice","REACT_APP_DEFAULT_URL","color","find","element","key","value","split","map","item","history","location","pathname","index","church_name","date","lecture_name","visit_log","status","e","target"],"mappings":"6mBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,+BAA5B,CACA,OAASC,MAAT,CAAiBC,WAAjB,KAAoC,cAApC,CACA,MAAOC,CAAAA,YAAP,KAAyB,eAAzB,CACA,MAAOC,CAAAA,UAAP,KAAuB,qBAAvB,CAEA,MAAO,+BAAP,CACA,MAAO,iCAAP,C,wFAGA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,KAAD,CAAW,CAC1B,cAA8CV,QAAQ,CAAC,IAAD,CAAtD,wCAAOW,eAAP,eAAwBC,kBAAxB,eACA,eAA8CZ,QAAQ,CAAC,IAAD,CAAtD,yCAAOa,eAAP,eAAwBC,kBAAxB,eACA,eAAsDd,QAAQ,CAAC,EAAD,CAA9D,yCAAOe,mBAAP,eAA4BC,sBAA5B,eACA,eAAoDhB,QAAQ,CAAC,IAAD,CAA5D,yCAAOiB,kBAAP,eAA2BC,qBAA3B,eACA,eAA8BlB,QAAQ,CAAC,KAAD,CAAtC,0CAAOmB,OAAP,gBAAgBC,UAAhB,gBACA,gBAAwBpB,QAAQ,CAAC,CAAD,CAAhC,2CAAOqB,IAAP,gBAAaC,OAAb,gBACA;AACA,gBAAwCtB,QAAQ,CAAC,EAAD,CAAhD,2CAAOuB,YAAP,gBAAqBC,eAArB,gBACA,gBAAsCxB,QAAQ,CAAC,IAAD,CAA9C,2CAAOyB,WAAP,gBAAoBC,cAApB,gBAEA,GAAIC,CAAAA,eAAe,CAAG,EAAtB,CAEA1B,SAAS,CAAC,UAAM,CACZ2B,oBAAoB,GACpBC,eAAe,GAClB,CAHQ,CAGP,EAHO,CAAT,CAKA,GAAMA,CAAAA,eAAe,0FAAG,sKACG1B,CAAAA,KAAK,CAAC2B,GAAN,CACnBC,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAqC,SADlB,CAC6B,CAC5CC,MAAM,CAAE,CACJC,KAAK,CAAEC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CADH,CADoC,CAD7B,CADH,QACdC,QADc,eAQpBb,cAAc,CAACa,QAAQ,CAACC,IAAV,CAAd,CARoB,sDAAH,kBAAfX,CAAAA,eAAe,0CAArB,CAWA,GAAMY,CAAAA,YAAY,2FAAG,kBAAMD,IAAN,wIACd3B,eAAe,GAAK,IAApB,EAA4BA,eAAe,GAAK2B,IADlC,gCAEVA,IAAI,CAACE,cAAL,GAAwB,IAFd,kDAGcvC,CAAAA,KAAK,CAAC2B,GAAN,CACnBC,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAqC,oBAArC,CAA0DO,IAAI,CAACG,WAD5C,CACyD,CACxET,MAAM,CAAE,CACJC,KAAK,CAAEC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CADH,CADgE,CADzD,CAHd,QAGHC,QAHG,gBAUTvB,sBAAsB,CAACuB,QAAQ,CAACC,IAAV,CAAtB,CAVS,OAYb1B,kBAAkB,CAAC0B,IAAD,CAAlB,CAZa,+BAcb1B,kBAAkB,CAAC,IAAD,CAAlB,CAda,yDAAH,kBAAZ2B,CAAAA,YAAY,6CAAlB,CAkBA,GAAMb,CAAAA,oBAAoB,2FAAG,4KACFzB,CAAAA,KAAK,CAAC2B,GAAN,CACnBC,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAqC,yBAArC,CAA+DG,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,IAA9B,CAD5C,CACiF,CAChGJ,MAAM,CAAE,CACJC,KAAK,CAAEC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CADH,CADwF,CADjF,CADE,QACnBC,QADmB,gBAQzB3B,kBAAkB,CAAC2B,QAAQ,CAACC,IAAV,CAAlB,CARyB,wDAAH,kBAApBZ,CAAAA,oBAAoB,2CAA1B,CAWA,GAAMgB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBxB,UAAU,CAAC,KAAD,CAAV,CACH,CAFD,CAGA,GAAMyB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACL,IAAD,CAAU,CACvBb,eAAe,CAAGa,IAAlB,CACH,CAFD,CAGA,GAAMM,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACN,IAAD,CAAU,CAC1B,CADD,CAEA,GAAMO,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,EAAD,CAAQ,CACxB,CADD,CAGA,GAAMC,CAAAA,iBAAiB,2FAAG,iKACnBb,MAAM,CAACc,OAAP,CAAe,iBAAf,CADmB,2BAElBC,QAAQ,CAACC,sBAAT,CAAgC,mBAAhC,EAAqD,CAArD,EAAwDC,KAAxD,GACA;AACA;AAEMnB,MANY,CAMH,GAAIoB,CAAAA,QAAJ,EANG,CAOZC,OAPY,CAOF,CACZ,eAAgB,oCADJ,CAEZ,SAAU,KAFE,CAPE,CAWlB;AACArB,MAAM,CAACsB,MAAP,CAAc,SAAd,CAAyBvC,kBAAzB,EAEA,IAAQwC,CAAR,CAAU,CAAV,CAAaA,CAAC,CAAC9B,eAAe,CAAC+B,MAA/B,CAAuCD,CAAC,EAAxC,CAA2C,CACvCvB,MAAM,CAACsB,MAAP,CAAc,MAAd,CAAsB7B,eAAe,CAAC8B,CAAD,CAAf,CAAmBE,IAAzC,EACH,CACDzB,MAAM,CAACsB,MAAP,CAAc,OAAd,CAAuBpB,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CAAvB,EACAJ,MAAM,CAACsB,MAAP,CAAc,UAAd,CAA0BpB,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,IAA9B,CAA1B,EAlBkB,wBAoBZnC,CAAAA,KAAK,CAACyD,IAAN,CACN7B,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAqC,gCAArC,CAAsEpB,eAAe,CAACmC,EADhF,CACoF;AAC1Fd,MAFM,CAEC,CAACqB,OAAO,CAAPA,OAAD,CAFD,EAEYM,IAFZ,CAEiB,SAASC,GAAT,CAAc,CACjCC,KAAK,CAAC,gBAAD,CAAL,CACAnC,oBAAoB,GACpBd,kBAAkB,CAAC,IAAD,CAAlB,CACH,CANK,CApBY,0DAAH,kBAAjBmC,CAAAA,iBAAiB,2CAAvB,CA6BA,GAAMe,CAAAA,YAAY,2FAAG,kBAAMxB,IAAN,sHACjB,GAAGJ,MAAM,CAACc,OAAP,CAAe,iBAAf,CAAH,CAAsC,CAClC/C,KAAK,CACD,CACI8D,GAAG,CAAElC,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAmC,cAD5C,CAEIiC,MAAM,CAAE,QAFZ,CAGI1B,IAAI,CAAE,CACFQ,EAAE,CAAEnC,eAAe,CAAC8B,WADlB,CAEFR,KAAK,CAAEC,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,OAA9B,CAFL,CAGF6B,QAAQ,CAAE/B,MAAM,CAACC,cAAP,CAAsBC,OAAtB,CAA8B,IAA9B,CAHR,CAHV,CADC,CAAL,CAUEuB,IAVF,CAUO,SAASC,GAAT,CAAc,CACjBC,KAAK,CAAC,cAAD,CAAL,CACAnC,oBAAoB,GACpBd,kBAAkB,CAAC,IAAD,CAAlB,CACH,CAdD,EAeH,CAjBgB,wDAAH,kBAAZkD,CAAAA,YAAY,8CAAlB,CAoBA,GAAMI,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAAC/C,IAAD,CAAU,CAC/BC,OAAO,CAACD,IAAD,CAAP,CACH,CAFD,CAIA,QAASgD,CAAAA,YAAT,CAAsBC,GAAtB,CAA2B,CACvB,GAAIC,CAAAA,WAAW,CAAGlD,IAAI,CAAGE,YAAzB,CACA,GAAIiD,CAAAA,YAAY,CAAGD,WAAW,CAAGhD,YAAjC,CAEA,GAAI8C,CAAAA,YAAY,CAAG,CAAnB,CACAA,YAAY,CAAG1D,eAAe,CAAC8D,KAAhB,CAAsBD,YAAtB,CAAoCD,WAApC,CAAf,CACA,MAAOF,CAAAA,YAAP,CACH,CAED,mBACI,oCACI,aAAK,SAAS,CAAC,cAAf,wBACI,YAAK,SAAS,CAAC,iBAAf,CAAiC,GAAG,CAAEtC,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,wBAAxE,CAAkG,GAAG,CAAC,cAAtG,EADJ,cAEI,aAAK,SAAS,CAAC,WAAf,wBACI,sDADJ,cAEI,UAAG,KAAK,CAAE,CAACC,KAAK,CAAC,OAAP,CAAV,UACKlD,WAAW,GAAK,IAAhB,CACDA,WAAW,CAACmD,IAAZ,CAAiB,SAAAC,OAAO,QAAIA,CAAAA,OAAO,CAACC,GAAR,GAAgB,qBAApB,EAAxB,EAAmEC,KAAnE,CAAyEC,KAAzE,CAA+E,OAA/E,EAAwFC,GAAxF,CAA6F,SAACC,IAAD,CAAOzB,CAAP,qBAAa,qBAAcyB,IAAd,EAAUzB,CAAV,CAAb,EAA7F,CADC,CAED,EAHJ,EAFJ,GAFJ,GADJ,cAaI,aAAK,SAAS,CAAC,mBAAf,wBACI,WAAI,KAAK,CAAE,CAACkB,KAAK,CAAC,OAAP,CAAX,4CADJ,cAEI,mBACKlD,WAAW,GAAK,IAAhB,CACDA,WAAW,CAACmD,IAAZ,CAAiB,SAAAC,OAAO,QAAIA,CAAAA,OAAO,CAACC,GAAR,GAAgB,qBAApB,EAAxB,EAAmEC,KAAnE,CAAyEC,KAAzE,CAA+E,OAA/E,EAAwFC,GAAxF,CAA6F,SAACC,IAAD,CAAOzB,CAAP,qBAAa,qBAAcyB,IAAd,EAAUzB,CAAV,CAAb,EAA7F,CADC,CAED,EAHJ,EAFJ,GAbJ,cAsBI,aAAK,SAAS,CAAC,iBAAf,wBACI,aAAK,SAAS,CAAC,aAAf,wBACI,mCACI,KAAC,IAAD,EAAM,SAAS,CAAE/C,KAAK,CAACyE,OAAN,CAAcC,QAAd,CAAuBC,QAAvB,GAAoCtD,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAtE,CAAwF,aAAxF,CAAsG,EAAvH,CAA2H,EAAE,CAAE3C,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAjK,uCADJ,EADJ,cAII,mCACI,KAAC,IAAD,EAAM,SAAS,CAAEhE,KAAK,CAACyE,OAAN,CAAcC,QAAd,CAAuBC,QAAvB,GAAoCtD,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAtE,CAAwF,aAAxF,CAAsG,EAAvH,CAA2H,EAAE,CAAE3C,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAjK,uCADJ,EAJJ,cAOI,mCACI,KAAC,IAAD,EAAM,SAAS,CAAEhE,KAAK,CAACyE,OAAN,CAAcC,QAAd,CAAuBC,QAAvB,GAAoCtD,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAtE,CAAwF,aAAxF,CAAsG,EAAvH,CAA2H,EAAE,CAAE3C,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,gBAAjK,uCADJ,EAPJ,cAUI,mCACA,KAAC,IAAD,EAAM,SAAS,CAAEhE,KAAK,CAACyE,OAAN,CAAcC,QAAd,CAAuBC,QAAvB,GAAoCtD,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,iBAAtE,CAAyF,aAAzF,CAAuG,EAAxH,CAA4H,EAAE,CAAE3C,OAAO,CAACC,GAAR,CAAY0C,qBAAZ,CAAkC,iBAAlK,sCADA,EAVJ,GADJ,cAeI,aAAK,SAAS,CAAC,eAAf,wBACI,aAAK,SAAS,CAAC,eAAf,wBACI,aAAK,SAAS,CAAC,iBAAf,wBACI,YAAK,SAAS,CAAC,gBAAf,EADJ,cAEI,YAAK,SAAS,CAAC,IAAf,mDAFJ,cAGI,YAAK,SAAS,CAAC,eAAf,6CAHJ,cAII,YAAK,SAAS,CAAC,IAAf,uCAJJ,GADJ,CAOM/D,eAAe,GAAK,IAApB,EAA4BA,eAAe,CAAC+C,MAAhB,EAA0B,CAAtD,CACEW,YAAY,CAAC1D,eAAD,CAAZ,CAA8BsE,GAA9B,CAAkC,SAACzC,IAAD,CAAO8C,KAAP,qBAC9B,aAAiB,SAAS,CAAEzE,eAAe,GAAK,IAApB,EAA4BA,eAAe,CAACmC,EAAhB,GAAuBR,IAAI,CAACQ,EAAxD,CAA6D,gCAA7D,CAAgG,iBAA5H,CAA+I,OAAO,CAAI,kBAAM,CAACP,YAAY,CAACD,IAAD,CAAZ,CAAmB,CAApL,wBACI,YAAK,SAAS,CAAC,gBAAf,UAAkC8C,KAAK,CAAC,CAAP,CAAW,CAACjE,IAAI,CAAC,CAAN,EAASE,YAArD,EADJ,cAEI,YAAK,SAAS,CAAC,IAAf,UAAqBiB,IAAI,CAAC+C,WAA1B,EAFJ,cAGI,YAAK,SAAS,CAAC,eAAf,UAAgC/C,IAAI,CAACgD,IAArC,EAHJ,CAIKhD,IAAI,CAACE,cAAL,GAAwB,IAAxB,cACG,aAAM,SAAS,CAAC,IAAhB,6CADH,cAEI,aAAM,SAAS,CAAC,IAAhB,mDANT,GAAU4C,KAAV,CAD8B,EAAlC,CADF,cAaE,YAAK,SAAS,CAAC,YAAf,gEApBR,GADJ,cAwBI,KAAC,UAAD,EACI,UAAU,CAAEjE,IADhB,CAEI,iBAAiB,CAAEE,YAFvB,CAGI,eAAe,CAAEZ,eAAe,GAAK,IAApB,CAA2BA,eAAe,CAAC+C,MAA3C,CAAoD,CAHzE,CAII,kBAAkB,CAAE,CAJxB,CAKI,YAAY,CAAE,GALlB,CAMI,YAAY,CAAE,GANlB,CAOI,QAAQ,CAAEU,gBAPd,EAxBJ,CAkCQvD,eAAe,GAAK,IAApB,EAA4BA,eAAe,CAAC6B,cAAhB,GAAmC,IAA/D,cACI,aAAK,SAAS,CAAC,qBAAf,wBACI,WAAG,SAAS,CAAC,SAAb,wBAAuB,aAAM,SAAS,CAAC,MAAhB,UAAwB7B,eAAe,CAAC4E,YAAxC,EAAvB,wDADJ,cAEI,UAAG,SAAS,CAAC,yBAAb,UAAwC5E,eAAe,CAAC6E,SAAhB,CAA0BV,KAA1B,CAAgC,IAAhC,EAAsCC,GAAtC,CAA2C,SAACC,IAAD,CAAOzB,CAAP,qBAAa,qBAAcyB,IAAd,EAAUzB,CAAV,CAAb,EAA3C,CAAxC,EAFJ,cAGI,YAAK,SAAS,CAAC,+BAAf,uBACI,KAAC,MAAD,EACI,YAAY,CAAE,EADlB,CAEI,MAAM,CAAE,MAFZ,CAGI,cAAc,CAAE,IAHpB,CAII,IAAI,CAAE,IAJV,CAIgB,sBAAsB,CAAE,IAJxC,CAKI,UAAU,CAAE,CACR,YAAa,IADL,CALhB,CAQI,UAAU,CAAE,IARhB,CASI,SAAS,CAAC,iBATd,UAUS1C,mBAAmB,GAAK,IAAxB,CACGA,mBAAmB,CAACkE,GAApB,CAAwB,SAACzC,IAAD,CAAO8C,KAAP,qBACpB,KAAC,WAAD,wBACI,YAAK,SAAS,CAAC,wBAAf,uBAAwC,YAAK,GAAG,CAAEvD,OAAO,CAACC,GAAR,CAAYC,sBAAZ,CAAmC,mBAAnC,CAAuDO,IAAjE,CAAuE,GAAG,CAAC,YAA3E,EAAxC,EADJ,EAAoB8C,KAApB,CADoB,EAAxB,CADH,cAMK,KAAC,YAAD,EAAc,IAAI,CAAC,MAAnB,CAA0B,KAAK,CAAC,SAAhC,EAhBd,EADJ,EAHJ,cAwBI,eAAQ,SAAS,CAAC,iBAAlB,CAAoC,OAAO,CAAEtB,YAA7C,sCAxBJ,GADJ,CA2BCnD,eAAe,GAAK,IAApB,EAA4BA,eAAe,CAAC8E,MAAhB,GAA2B,CAAvD,cACG,aAAK,SAAS,CAAC,qBAAf,wBACI,WAAG,SAAS,CAAC,SAAb,wBAAuB,aAAM,SAAS,CAAC,MAAhB,UAAwB9E,eAAe,CAAC4E,YAAxC,EAAvB,wDADJ,cAEI,iBAAU,SAAS,CAAC,mBAApB,CAAwC,WAAW,CAAC,2BAApD,CAA4D,QAAQ,CAAE,kBAACG,CAAD,CAAO,CAAC1E,qBAAqB,CAAC0E,CAAC,CAACC,MAAF,CAASd,KAAV,CAArB,CAAwC,CAAtH,EAFJ,cAGI,KAAC,WAAD,EACI,MAAM,CAAE5D,OADZ,CAEI,SAAS,CAAEyB,SAFf,CAGI,QAAQ,CAAEE,QAHd,CAII,QAAQ,CAAED,QAJd,CAKI,QAAQ,CAAEE,QALd,CAMI,WAAW,CAAE,EANjB,EAHJ,cAWI,eAAQ,SAAS,CAAC,iBAAlB,CAAoC,OAAO,CAAE,yBAAME,CAAAA,iBAAiB,EAAvB,EAA7C,mDAXJ,GADH,CAcA,IA3ET,GAfJ,GAtBJ,GADJ,CAwHH,CA3PD,CA6PA,cAAexC,CAAAA,UAAf","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport { RMIUploader } from \"react-multiple-image-uploader\";\nimport { Swiper, SwiperSlide } from \"swiper/react\";\nimport ReactLoading from \"react-loading\";\nimport Pagination from \"react-js-pagination\";\n\nimport '../../../assets/css/table.css';\nimport '../../../assets/css/Contact.css';\n\n\nconst VisitDiary = (props) => {\n    const [applicationInfo, setapplicationInfo] = useState(null);\n    const [selectedLecture, setSelectedLecture] = useState(null);\n    const [visitingLogFileData, setVisitingLogFileData] = useState([]);\n    const [visitingLogContent, setVisitingLogContent] = useState(null)\n    const [visible, setVisible] = useState(false);\n    const [page, setPage] = useState(1);\n    // eslint-disable-next-line no-unused-vars\n    const [postsPerPage, setpostsPerPage] = useState(10);\n    const [settingInfo, setsettingInfo] = useState(null);\n\n    var visitingLogFile = [];\n\n    useEffect(() => {\n        readApplicationForms();\n        readSettingInfo();\n    },[]);\n\n    const readSettingInfo = async () => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'setting', {\n                params: {\n                    token: window.sessionStorage.getItem('token')\n                }\n            }\n        );\n        setsettingInfo(response.data)        \n    }\n\n    const selectButton = async(data) => {\n        if(selectedLecture === null || selectedLecture !== data) {\n            if(data.visit_reg_date !== null){\n                const response = await axios.get(\n                    process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/file/'+data.feedback_id, {\n                        params: {\n                            token: window.sessionStorage.getItem('token')\n                        }\n                    }\n                );\n                setVisitingLogFileData(response.data);\n            }\n            setSelectedLecture(data);\n        } else {\n            setSelectedLecture(null);\n        }\n    }\n\n    const readApplicationForms = async() => {\n        const response = await axios.get(\n            process.env.REACT_APP_RESTAPI_HOST + 'application/instructor/'+window.sessionStorage.getItem('id'), {\n                params: {\n                    token: window.sessionStorage.getItem('token')\n                }\n            }\n        );\n        setapplicationInfo(response.data);\n    }\n\n    const hideModal = () => {\n        setVisible(false);\n    };\n    const onUpload = (data) => {\n        visitingLogFile = data;\n    };\n    const onSelect = (data) => {\n    };\n    const onRemove = (id) => {\n    };\n\n    const insertVisitingLog = async() => {\n        if(window.confirm(\"방문일지를 저장하시겠습니까?\")) {\n            document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n            //document.getElementsByClassName(\"ant-btn-icon-only\")[1].click();\n            //const blob = await fetch(base64).then(res => res.blob());\n\n            const params = new FormData();\n            const headers = {\n                'Content-type': 'multipart/form-data; charset=UTF-8',\n                'Accept': '*/*'\n            }\n            //var params = new URLSearchParams();\n            params.append('content', visitingLogContent);\n\n            for(var i=0; i<visitingLogFile.length; i++){\n                params.append('file', visitingLogFile[i].file);\n            }\n            params.append('token', window.sessionStorage.getItem('token'));\n            params.append('manageID', window.sessionStorage.getItem('id'));\n            \n            await axios.post(\n            process.env.REACT_APP_RESTAPI_HOST + 'visiting_log/application_form/'+selectedLecture.id, //[loginID]로그인 후 변경\n            params,{headers}).then(function(res) {\n                alert(\"방문일지가 저장되었습니다.\")\n                readApplicationForms();\n                setSelectedLecture(null);\n            });\n        }\n    };\n    const deleteButton = async(data) => {\n        if(window.confirm(\"방문일지를 삭제하시겠습니까?\")) {\n            axios(\n                {\n                    url: process.env.REACT_APP_RESTAPI_HOST+'visiting_log',\n                    method: 'delete',\n                    data: {\n                        id: selectedLecture.feedback_id,\n                        token: window.sessionStorage.getItem('token'),\n                        manageID: window.sessionStorage.getItem('id')\n                    }\n                }\n            ).then(function(res) {\n                alert(\"삭제가 완료되었습니다.\")\n                readApplicationForms();\n                setSelectedLecture(null);\n            })\n        }\n    }\n\n    const handlePageChange = (page) => { \n        setPage(page); \n    };\n\n    function currentPosts(tmp) {\n        var indexOfLast = page * postsPerPage;\n        var indexOfFirst = indexOfLast - postsPerPage;\n\n        let currentPosts = 0;\n        currentPosts = applicationInfo.slice(indexOfFirst, indexOfLast);\n        return currentPosts;\n    }\n\n    return (\n        <div>\n            <div className=\"mypage-image\">\n                <img className=\"page-background\" src={process.env.REACT_APP_DEFAULT_URL+'image/application.jpeg'} alt=\"lecture page\" />\n                <div className=\"page-info\">\n                    <h2>마이페이지</h2>\n                    <p style={{color:'black'}}>\n                        {settingInfo !== null ?\n                        settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map( (item, i) => <div key={i}>{item}</div>) :\n                        \"\"\n                        }\n                    </p>\n                </div>\n            </div>\n            <div className=\"inst-title-header\">\n                <h2 style={{color:'white'}}>마이페이지</h2>\n                <p>\n                    {settingInfo !== null ?\n                    settingInfo.find(element => element.key === \"mypage_visit_phrase\").value.split(\"<br/>\").map( (item, i) => <div key={i}>{item}</div>) :\n                    \"\"\n                    }\n                </p>\n            </div>\n            <div className=\"content-wrapper\">\n                <div className=\"left-navbar\">\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/profile\"}>내 프로필</Link>\n                    </span>\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/lecture\"}>내 강의함</Link>\n                    </span>\n                    <span>\n                        <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/contact\"}>컨택 일정</Link>\n                    </span>\n                    <span>\n                    <Link className={props.history.location.pathname === process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\"? \"left-active\":\"\"} to={process.env.REACT_APP_DEFAULT_URL+\"mypage/visitlog\"}>방문일지</Link>\n                    </span>\n                </div>\n                <div className=\"right-content\">\n                    <div className=\"table-wrapper\">\n                        <div className=\"table-row-visit\">\n                            <div className=\"th visit-index\"></div>\n                            <div className=\"th\">방문한 교회명</div>\n                            <div className=\"th visit-date\">다녀온 날짜</div>\n                            <div className=\"th\">일지 작성</div>\n                        </div>\n                        { applicationInfo !== null && applicationInfo.length >= 1?\n                            currentPosts(applicationInfo).map((data, index) => \n                                <div key={index} className={selectedLecture !== null && selectedLecture.id === data.id ? \"click-inst-row table-row-visit\" : \"table-row-visit\"} onClick = {() => {selectButton(data)}}>\n                                    <div className=\"td visit-index\">{(index+1)+((page-1)*postsPerPage)}</div>\n                                    <div className=\"td\">{data.church_name}</div>\n                                    <div className=\"td visit-date\">{data.date}</div>\n                                    {data.visit_reg_date !== null?\n                                        <span className=\"td\">피드백 완료</span>\n                                        :<span className=\"td\">피드백 미완료</span>\n                                    }\n                                </div>\n                            )\n                            :\n                            <div className=\"no-content\">신청서가 없습니다.</div>\n                        }\n                    </div>\n                    <Pagination \n                        activePage={page} \n                        itemsCountPerPage={postsPerPage} \n                        totalItemsCount={applicationInfo !== null ? applicationInfo.length : 0} \n                        pageRangeDisplayed={5} \n                        prevPageText={\"‹\"} \n                        nextPageText={\"›\"} \n                        onChange={handlePageChange} \n                    />\n                    {\n                        selectedLecture !== null && selectedLecture.visit_reg_date !== null?\n                            <div className=\"show-lecture-detail\">\n                                <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                                <p className=\"feedback-detail-content\">{selectedLecture.visit_log.split(\"\\n\").map( (item, i) => <div key={i}>{item}</div>)}</p>\n                                <div className=\"feedback-image-swiper-wrapper\">\n                                    <Swiper \n                                        spaceBetween={30} \n                                        effect={'fade'}\n                                        centeredSlides={true} \n                                        loop={true} loopFillGroupWithBlank={true}\n                                        pagination={{\n                                            \"clickable\": true\n                                        }} \n                                        navigation={true}\n                                        className=\"feedback-swiper\">\n                                            {visitingLogFileData !== null ?\n                                                visitingLogFileData.map((data, index) => (\n                                                    <SwiperSlide key = {index}>\n                                                        <div className=\"feedback-image-wrapper\"><img src={process.env.REACT_APP_RESTAPI_HOST+\"resources/upload/\"+data} alt=\"uploadFile\"/></div>\n                                                    </SwiperSlide>\n                                                ))\n                                                : <ReactLoading type=\"spin\" color=\"#05589c\" />\n                                            }\n                                    </Swiper>\n                                </div>\n                                <button className=\"feedback-submit\" onClick={deleteButton}>삭제하기</button>\n                            </div>\n                        :selectedLecture !== null && selectedLecture.status === 2?\n                            <div className=\"show-lecture-detail\">\n                                <p className=\"regular\"><span className=\"bold\">{selectedLecture.lecture_name}</span>를 강연하셨습니다.</p>\n                                <textarea className=\"feedback-textarea\" placeholder=\"글 남기기\" onChange={(e) => {setVisitingLogContent(e.target.value); }}></textarea>\n                                <RMIUploader\n                                    isOpen={visible}\n                                    hideModal={hideModal}\n                                    onSelect={onSelect}\n                                    onUpload={onUpload}\n                                    onRemove={onRemove}\n                                    dataSources={[]}\n                                />\n                                <button className=\"feedback-submit\" onClick={() => insertVisitingLog()}>작성 완료하기</button>\n                            </div>\n                        :null\n                    }\n                </div>\n\n            </div>\n        </div>\n    )\n}\n\nexport default VisitDiary;"]},"metadata":{},"sourceType":"module"}